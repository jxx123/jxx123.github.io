---
layout: article
title: Algorithm Notes
key: algorithm-notes
tags: algorithm data_structure
excerpt_separator: <!--more-->
excerpt_type: html
---
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-05-16 Sat 23:20 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Jinyu Xie" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style>pre.src{background:#343131;color:white;} </style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<div id="outline-container-orgfc627ee" class="outline-2">
<h2 id="orgfc627ee"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
This is my journey into Algorithm and Data Structures. I implemented quite a
bunch of classical algorithms based on the holy bible <a href="https://www.amazon.com/Introduction-Algorithms-3rd-MIT-Press/dp/0262033844">Introduction to
Algorithms</a>. End up getting offers from Amazon Alexa (Applied Scientist), Uber
(Software Engineer), Google (Software Engineer), Microsoft (Software
Engineer) with a Mechanical Engineering background.
</p>
<!--more-->
</div>
</div>
<div id="outline-container-org39d37b6" class="outline-2">
<h2 id="org39d37b6"><span class="section-number-2">2</span> Algorithms</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgbd28e5f" class="outline-3">
<h3 id="orgbd28e5f"><span class="section-number-3">2.1</span> Loop invariant</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Initialization</li>
<li>Maintenance</li>
<li>Termination</li>
</ul>
</div>
</div>
<div id="outline-container-org2ab8bfb" class="outline-3">
<h3 id="org2ab8bfb"><span class="section-number-3">2.2</span> Asymptotic notation</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>&Theta;(g(n)) asymptotic tight bound: there exists c<sub>1</sub>, c<sub>2</sub>, such that c<sub>1</sub>*g(n) &le; f(n) &le; c<sub>2</sub>*g(n).</li>
<li>O(g(n)) asymptotic upper bound: there exists c such that 0 &le; f(n) &le; c*g(n).</li>
<li>&Omega;(g(n)) asymptotic lower bound: there exists c such that c*g(n) &le; f(n).</li>
</ul>
</div>
</div>
<div id="outline-container-orge3efe3d" class="outline-3">
<h3 id="orge3efe3d"><span class="section-number-3">2.3</span> Master Theorem</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Given the recurrence equation:
T(n) = aT(n/b) + f(n)
</p>
<ul class="org-ul">
<li>If f(n) = O(n<sup>log<sub>b</sub> a - &epsilon;</sup>) for some constant &epsilon;, then T(n) = &Theta;(n<sup>log<sub>b</sub> a</sup>). That is if f(n) is polynomially faster than n<sup>log<sub>b</sub> a</sup> then the time will be dominated by n<sup>log<sub>b</sub> a</sup>.</li>
<li>If f(n) = &Theta;(n<sup>log<sub>b</sub> a</sup> * log<sup>k</sup> n) for any k &ge; 0, then T(n) = &Theta;(n<sup>log<sub>b</sub> a</sup> log<sup>k + 1</sup> n).</li>
<li>If f(n) = &Omega;(n<sup>log<sub>b</sub> a + &epsilon;</sup>) for some constant &epsilon;, and if af(n/b) &le; cf(n) for some constant c, then T(n) = &Theta;(f(n)). That is f(n) is polynomially slower than n<sup>log<sub>b</sub> a</sup>, then the time will be dominated by f(n).
Can be translated as
<ul class="org-ul">
<li><b><b>Too many leaves</b></b>. Number of leaf nodes outweighs the sum of the internal evaluation cost. The total running time is O(n<sup>log<sub>b</sub> a</sup>).</li>
<li><b><b>Equal work per level</b></b>. Each level cost n<sup>log<sub>b</sub> a</sup> time, and there are log<sub>b</sub> n levels. Total time O(n<sup>log<sub>b</sub> a</sup> log n).</li>
<li><b><b>Too expensive a root</b></b>. The internal evaluation costs dominates. O(f(n)).</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org0b57de9" class="outline-3">
<h3 id="org0b57de9"><span class="section-number-3">2.4</span> Sort</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org2367989" class="outline-4">
<h4 id="org2367989"><span class="section-number-4">2.4.1</span> Insertion Sort</h4>
<div class="outline-text-4" id="text-2-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insertion_sort</span><span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span> == <span style="color: #AE81FF;">1</span>:
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> arr

    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>arr<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">Get the latest unsorted value</span>
        <span style="color: #FD971F;">key</span> = arr<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
        <span style="color: #FD971F;">j</span> = i - <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">while</span> arr<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> &gt; key <span style="color: #F92672;">and</span> j &gt;= <span style="color: #AE81FF;">0</span>:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">When the current value is larger than the unsorted value, shift</span>
            <span style="color: #75715E;"># </span><span style="color: #75715E;">the current value to the right</span>
            <span style="color: #FD971F;">arr</span><span style="color: #AE81FF;">[</span>j + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = arr<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">j</span> -= <span style="color: #AE81FF;">1</span>

        <span style="color: #75715E;"># </span><span style="color: #75715E;">The current value arr[j] is either smaller than the unsorted value,</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">or the current position is -1.</span>
        <span style="color: #FD971F;">arr</span><span style="color: #AE81FF;">[</span>j + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = key
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">return</span> arr



<span style="color: #FD971F;">a</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">8</span>, <span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
insertion_sort<span style="color: #AE81FF;">(</span>a<span style="color: #AE81FF;">)</span>

insertion_sort<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>

insertion_sort<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[2, 5, 3, 8, 7, 1]
[2, 5, 5, 8, 7, 1]
[2, 3, 5, 8, 7, 1]
[2, 3, 5, 8, 7, 1]
[2, 3, 5, 8, 8, 1]
[2, 3, 5, 7, 8, 1]
[2, 3, 5, 7, 8, 8]
[2, 3, 5, 7, 7, 8]
[2, 3, 5, 5, 7, 8]
[2, 3, 3, 5, 7, 8]
[2, 2, 3, 5, 7, 8]
[1, 2, 3, 5, 7, 8]
[1]
[2, 2, 2, 1]
[2, 2, 2, 1]
[2, 2, 2, 2]
[2, 2, 2, 2]
[2, 2, 2, 2]
[1, 2, 2, 2]
</pre>
</div>
</div>
<div id="outline-container-org9a150ec" class="outline-4">
<h4 id="org9a150ec"><span class="section-number-4">2.4.2</span> Merge Sort</h4>
<div class="outline-text-4" id="text-2-4-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">mergeSort</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">return</span> mergeSortHelper<span style="color: #AE81FF;">(</span>A, <span style="color: #AE81FF;">0</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">mergeSortHelper</span><span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> left == right:
        <span style="color: #F92672;">return</span> A<span style="color: #AE81FF;">[</span>left:right + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">mid</span> = left + <span style="color: #AE81FF;">(</span>right - left<span style="color: #AE81FF;">)</span> // <span style="color: #AE81FF;">2</span>
    <span style="color: #FD971F;">A_left</span> = mergeSortHelper<span style="color: #AE81FF;">(</span>A, left, mid<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">A_right</span> = mergeSortHelper<span style="color: #AE81FF;">(</span>A, mid + <span style="color: #AE81FF;">1</span>, right<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> mergeArray<span style="color: #AE81FF;">(</span>A_left, A_right<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">mergeArray</span><span style="color: #AE81FF;">(</span>A, B<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">i</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #FD971F;">j</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #FD971F;">merged</span> = <span style="color: #AE81FF;">[]</span>
    <span style="color: #F92672;">while</span> i &lt; <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span> <span style="color: #F92672;">and</span> j &lt; <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>B<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> &lt; B<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span>:
            merged.append<span style="color: #AE81FF;">(</span>A<span style="color: #66D9EF;">[</span>i<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">i</span> += <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">else</span>:
            merged.append<span style="color: #AE81FF;">(</span>B<span style="color: #66D9EF;">[</span>j<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">j</span> += <span style="color: #AE81FF;">1</span>

    <span style="color: #F92672;">if</span> i == <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>:
        merged.extend<span style="color: #AE81FF;">(</span>B<span style="color: #66D9EF;">[</span>j:<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">else</span>:
        merged.extend<span style="color: #AE81FF;">(</span>A<span style="color: #66D9EF;">[</span>i:<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> merged

<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">9</span>, <span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">7</span><span style="color: #AE81FF;">]</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>mergeSort<span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[2, 3, 6, 6, 7, 7, 9]

</pre>
</div>
</div>

<div id="outline-container-org34ed30d" class="outline-4">
<h4 id="org34ed30d"><span class="section-number-4">2.4.3</span> Quick Sort</h4>
<div class="outline-text-4" id="text-2-4-3">
<ul class="org-ul">
<li>Simple Quick Sort</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">quick_sort</span><span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> left &lt; right:
        <span style="color: #FD971F;">mid</span> = partition<span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Pivot Index: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>mid<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
        quick_sort<span style="color: #AE81FF;">(</span>A, left, mid<span style="color: #AE81FF;">)</span>
        quick_sort<span style="color: #AE81FF;">(</span>A, mid + <span style="color: #AE81FF;">1</span>, right<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">partition</span><span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Partition {} to {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>left, right<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">pivot</span> = A<span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Pivot value: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>pivot<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">i</span> = left
    <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>left, right<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> A<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> &lt; pivot:
            A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">A</span><span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> = A<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span>, A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
            <span style="color: #FD971F;">i</span> += <span style="color: #AE81FF;">1</span>
    A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">A</span><span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span> = A<span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span>, A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">return</span> i - <span style="color: #AE81FF;">1</span>


<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">8</span>, <span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">]</span>
quick_sort<span style="color: #AE81FF;">(</span>A, <span style="color: #AE81FF;">0</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
quick_sort<span style="color: #AE81FF;">(</span>A, <span style="color: #AE81FF;">0</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Partition 0 to 7
Pivot value: 4
Pivot Index: 2
[2, 1, 3, 4, 7, 5, 6, 8]
Partition 0 to 2
Pivot value: 3
Pivot Index: 1
[2, 1, 3, 4, 7, 5, 6, 8]
Partition 0 to 1
Pivot value: 1
Pivot Index: -1
[1, 2, 3, 4, 7, 5, 6, 8]
Partition 0 to 1
Pivot value: 2
Pivot Index: 0
[1, 2, 3, 4, 7, 5, 6, 8]
Partition 3 to 7
Pivot value: 8
Pivot Index: 6
[1, 2, 3, 4, 7, 5, 6, 8]
Partition 3 to 6
Pivot value: 6
Pivot Index: 4
[1, 2, 3, 4, 5, 6, 7, 8]
Partition 3 to 4
Pivot value: 5
Pivot Index: 3
[1, 2, 3, 4, 5, 6, 7, 8]
Partition 5 to 6
Pivot value: 7
Pivot Index: 5
[1, 2, 3, 4, 5, 6, 7, 8]
[1, 2, 3, 4, 5, 6, 7, 8]
[1]
</pre>


<ul class="org-ul">
<li>Randomized quick sort</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">import</span> random


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">quick_sort</span><span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> left &lt; right:
        <span style="color: #FD971F;">mid</span> = random_partition<span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Pivot Index: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>mid<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
        quick_sort<span style="color: #AE81FF;">(</span>A, left, mid<span style="color: #AE81FF;">)</span>
        quick_sort<span style="color: #AE81FF;">(</span>A, mid + <span style="color: #AE81FF;">1</span>, right<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">random_partition</span><span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">pivot_index</span> = random.randint<span style="color: #AE81FF;">(</span>left, right<span style="color: #AE81FF;">)</span>
    A<span style="color: #AE81FF;">[</span>pivot_index<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">A</span><span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span> = A<span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span>, A<span style="color: #AE81FF;">[</span>pivot_index<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">return</span> partition<span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">partition</span><span style="color: #AE81FF;">(</span>A, left, right<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Partition {} to {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>left, right<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">pivot</span> = A<span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Pivot value: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>pivot<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">i</span> = left
    <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>left, right<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> A<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> &lt; pivot:
            A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">A</span><span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> = A<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span>, A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
            <span style="color: #FD971F;">i</span> += <span style="color: #AE81FF;">1</span>
            A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">A</span><span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span> = A<span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span>, A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">return</span> i - <span style="color: #AE81FF;">1</span>


<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">8</span>, <span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">]</span>
quick_sort<span style="color: #AE81FF;">(</span>A, <span style="color: #AE81FF;">0</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
quick_sort<span style="color: #AE81FF;">(</span>A, <span style="color: #AE81FF;">0</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Partition 0 to 7
Pivot value: 3
Pivot Index: 1
[2, 1, 8, 3, 4, 5, 6, 7]
Partition 0 to 1
Pivot value: 1
Pivot Index: -1
[2, 1, 8, 3, 4, 5, 6, 7]
Partition 0 to 1
Pivot value: 2
Pivot Index: 0
[1, 2, 8, 3, 4, 5, 6, 7]
Partition 2 to 7
Pivot value: 8
Pivot Index: 5
[1, 2, 7, 4, 5, 6, 3, 8]
Partition 2 to 5
Pivot value: 6
Pivot Index: 3
[1, 2, 4, 5, 7, 6, 3, 8]
Partition 2 to 3
Pivot value: 5
Pivot Index: 2
[1, 2, 4, 5, 7, 6, 3, 8]
Partition 4 to 5
Pivot value: 7
Pivot Index: 4
[1, 2, 4, 5, 6, 7, 3, 8]
Partition 6 to 7
Pivot value: 8
Pivot Index: 6
[1, 2, 4, 5, 6, 7, 3, 8]
[1, 2, 4, 5, 6, 7, 3, 8]
[1]
</pre>
</div>
</div>

<div id="outline-container-org62fc3a6" class="outline-4">
<h4 id="org62fc3a6"><span class="section-number-4">2.4.4</span> Heap Sort</h4>
<div class="outline-text-4" id="text-2-4-4">
<p>
<a href="#org2043a32">Heap</a>
</p>
</div>
</div>
<div id="outline-container-org13d26fe" class="outline-4">
<h4 id="org13d26fe"><span class="section-number-4">2.4.5</span> Counting Sort</h4>
<div class="outline-text-4" id="text-2-4-5">
<p>
Count the times of each element, and put the element to the place of the counting number.
</p>
<ul class="org-ul">
<li>NOTE: the lower bound of comparison sort is &Theta;(n log n), counting sort is not a comparison sort. It can sort the array in linear time.</li>
<li>The time complexity of counting sort is O(n + k), given that the elements in the array are from 0 to k.</li>
<li>It is stable, but not in place. It takes O(n + k) memory.</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">counting_sort</span><span style="color: #AE81FF;">(</span>A, B, k<span style="color: #AE81FF;">)</span>:
    <span style="color: #E6DB74;">"""Counting sort</span>
<span style="color: #E6DB74;">    Sort A and put the sorted results into B. The elements in A are assumed</span>
<span style="color: #E6DB74;">    from 0 to k</span>
<span style="color: #E6DB74;">    """</span>
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Array to save counts</span>
    <span style="color: #FD971F;">C</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>k + <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">for</span> a <span style="color: #F92672;">in</span> A:
        <span style="color: #FD971F;">C</span><span style="color: #AE81FF;">[</span>a<span style="color: #AE81FF;">]</span> += <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Counted array: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>C<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

    <span style="color: #75715E;"># </span><span style="color: #75715E;">Accumulate the counts</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>C<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">C</span><span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> += C<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Accumulated counts: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>C<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

    <span style="color: #75715E;"># </span><span style="color: #75715E;">The reason to start from the end is to maintain the stability of the</span>
    <span style="color: #75715E;"># </span><span style="color: #75715E;">sort, because the count number starts from the largest position</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span>, -<span style="color: #AE81FF;">1</span>, -<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
        B<span style="color: #AE81FF;">[</span>C<span style="color: #66D9EF;">[</span>A<span style="color: #A6E22E;">[</span>i<span style="color: #A6E22E;">]</span><span style="color: #66D9EF;">]</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
        C<span style="color: #AE81FF;">[</span>A<span style="color: #66D9EF;">[</span>i<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">]</span> -= <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Current sorted array B: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>B<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Current counting array C: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>C<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>


<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">B</span> = <span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">8</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
counting_sort<span style="color: #AE81FF;">(</span>A, B, <span style="color: #AE81FF;">5</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Sorted array B: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>B<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Counted array: [0, 0, 1, 0, 0, 0]
Counted array: [0, 0, 1, 0, 0, 1]
Counted array: [0, 0, 1, 1, 0, 1]
Counted array: [1, 0, 1, 1, 0, 1]
Counted array: [1, 0, 2, 1, 0, 1]
Counted array: [1, 0, 2, 2, 0, 1]
Counted array: [2, 0, 2, 2, 0, 1]
Counted array: [2, 0, 2, 3, 0, 1]
Accumulated counts: [2, 2, 2, 3, 0, 1]
Accumulated counts: [2, 2, 4, 3, 0, 1]
Accumulated counts: [2, 2, 4, 7, 0, 1]
Accumulated counts: [2, 2, 4, 7, 7, 1]
Accumulated counts: [2, 2, 4, 7, 7, 8]
Current sorted array B: [-1, -1, -1, -1, -1, -1, 3, -1]
Current counting array C: [2, 2, 4, 6, 7, 8]
Current sorted array B: [-1, 0, -1, -1, -1, -1, 3, -1]
Current counting array C: [1, 2, 4, 6, 7, 8]
Current sorted array B: [-1, 0, -1, -1, -1, 3, 3, -1]
Current counting array C: [1, 2, 4, 5, 7, 8]
Current sorted array B: [-1, 0, -1, 2, -1, 3, 3, -1]
Current counting array C: [1, 2, 3, 5, 7, 8]
Current sorted array B: [0, 0, -1, 2, -1, 3, 3, -1]
Current counting array C: [0, 2, 3, 5, 7, 8]
Current sorted array B: [0, 0, -1, 2, 3, 3, 3, -1]
Current counting array C: [0, 2, 3, 4, 7, 8]
Current sorted array B: [0, 0, -1, 2, 3, 3, 3, 5]
Current counting array C: [0, 2, 3, 4, 7, 7]
Current sorted array B: [0, 0, 2, 2, 3, 3, 3, 5]
Current counting array C: [0, 2, 2, 4, 7, 7]
Sorted array B: [0, 0, 2, 2, 3, 3, 3, 5]
</pre>
</div>
</div>

<div id="outline-container-org00675ea" class="outline-4">
<h4 id="org00675ea"><span class="section-number-4">2.4.6</span> <span class="todo TODO">TODO</span> Radix sort</h4>
<div class="outline-text-4" id="text-2-4-6">
<ul class="org-ul">
<li>Split the number into multiple digit, and perform <b><b>STABLE</b></b> sort for each each digit from smaller digit to larger digit.</li>
<li>Pseudo code:
for i = 1 to d:
perform stable sort to sort array A on digit i</li>
<li>If using counting sort as the underlying stable sorting algorithm, the time complexity is O(d(n + k))</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">radix_sort</span><span style="color: #AE81FF;">(</span>A, d<span style="color: #AE81FF;">)</span>:
    <span style="color: #75715E;"># </span><span style="color: #cc9393;">TODO</span>
    <span style="color: #F92672;">pass</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2171879" class="outline-4">
<h4 id="org2171879"><span class="section-number-4">2.4.7</span> Bucket Sort</h4>
</div>
<div id="outline-container-orgcdfbc74" class="outline-4">
<h4 id="orgcdfbc74"><span class="section-number-4">2.4.8</span> Patience Sort</h4>
<div class="outline-text-4" id="text-2-4-8">
<p>
Very efficient algorithm to solve Longest Increasing Subsequence Problem.
<a href="https://leetcode.com/problems/longest-increasing-subsequence/">https://leetcode.com/problems/longest-increasing-subsequence/</a>
<a href="https://www.cs.princeton.edu/courses/archive/spring13/cos423/lectures/LongestIncreasingSubsequence.pdf">https://www.cs.princeton.edu/courses/archive/spring13/cos423/lectures/LongestIncreasingSubsequence.pdf</a>
<a href="https://en.wikipedia.org/wiki/Patience_sorting">https://en.wikipedia.org/wiki/Patience_sorting</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org998c777" class="outline-3">
<h3 id="org998c777"><span class="section-number-3">2.5</span> Maximum-subarray problem</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Find the subarray that has the maximum sum.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">find_max_subarray</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">low</span>, <span style="color: #FD971F;">high</span>, <span style="color: #FD971F;">max_sum</span> = helper_find_max_subarray<span style="color: #AE81FF;">(</span>A, <span style="color: #AE81FF;">0</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>A<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> low, high, max_sum


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">helper_find_max_subarray</span><span style="color: #AE81FF;">(</span>A, low, high<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> low == high:
        <span style="color: #F92672;">return</span> low, high, A<span style="color: #AE81FF;">[</span>low<span style="color: #AE81FF;">]</span>

    <span style="color: #FD971F;">mid</span> = <span style="color: #AE81FF;">(</span>low + high<span style="color: #AE81FF;">)</span> // <span style="color: #AE81FF;">2</span>

    <span style="color: #FD971F;">left_low</span>, <span style="color: #FD971F;">left_high</span>, <span style="color: #FD971F;">left_sum</span> = helper_find_max_subarray<span style="color: #AE81FF;">(</span>A, low, mid<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">right_low</span>, <span style="color: #FD971F;">right_high</span>, <span style="color: #FD971F;">right_sum</span> = helper_find_max_subarray<span style="color: #AE81FF;">(</span>A, mid + <span style="color: #AE81FF;">1</span>, high<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">cross_low</span>, <span style="color: #FD971F;">cross_high</span>, <span style="color: #FD971F;">cross_sum</span> = helper_find_cross_max_subarray<span style="color: #AE81FF;">(</span>A, low, mid, high<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">if</span> left_sum &gt;= right_sum <span style="color: #F92672;">and</span> left_sum &gt;= cross_sum:
        <span style="color: #F92672;">return</span> left_low, left_high, left_sum
    <span style="color: #F92672;">elif</span> right_sum &gt;= left_sum <span style="color: #F92672;">and</span> right_sum &gt;= cross_sum:
        <span style="color: #F92672;">return</span> right_low, right_high, right_sum
    <span style="color: #F92672;">else</span>:
        <span style="color: #F92672;">return</span> cross_low, cross_high, cross_sum


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">helper_find_cross_max_subarray</span><span style="color: #AE81FF;">(</span>A, low, mid, high<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">left_sum</span> = A<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">left_low</span> = mid
    <span style="color: #FD971F;">tmp_sum</span> = A<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">i</span> = mid - <span style="color: #AE81FF;">1</span>
    <span style="color: #F92672;">while</span> i &gt;= low:
        <span style="color: #FD971F;">tmp_sum</span> += A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">if</span> tmp_sum &gt; left_sum:
            <span style="color: #FD971F;">left_sum</span> = tmp_sum
            <span style="color: #FD971F;">left_low</span> = i
        <span style="color: #FD971F;">i</span> -= <span style="color: #AE81FF;">1</span>

    <span style="color: #FD971F;">right_sum</span> = A<span style="color: #AE81FF;">[</span>mid + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">right_high</span> = mid + <span style="color: #AE81FF;">1</span>
    <span style="color: #FD971F;">tmp_sum</span> = A<span style="color: #AE81FF;">[</span>mid + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">i</span> = mid + <span style="color: #AE81FF;">1</span>
    <span style="color: #F92672;">while</span> i &lt;= high:
        <span style="color: #FD971F;">tmp_sum</span> += A<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">if</span> tmp_sum &gt; right_sum:
            <span style="color: #FD971F;">right_sum</span> = tmp_sum
            <span style="color: #FD971F;">right_high</span> = i
        <span style="color: #FD971F;">i</span> += <span style="color: #AE81FF;">1</span>

    <span style="color: #F92672;">return</span> left_low, right_high, left_sum + right_sum

<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">13</span>, -<span style="color: #AE81FF;">3</span>, -<span style="color: #AE81FF;">25</span>, <span style="color: #AE81FF;">20</span>, -<span style="color: #AE81FF;">3</span>, -<span style="color: #AE81FF;">16</span>, -<span style="color: #AE81FF;">23</span>, <span style="color: #AE81FF;">18</span>, <span style="color: #AE81FF;">20</span>, -<span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">12</span>, -<span style="color: #AE81FF;">5</span>, -<span style="color: #AE81FF;">22</span>, <span style="color: #AE81FF;">15</span>, -<span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">7</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">low</span>, <span style="color: #FD971F;">high</span>, <span style="color: #FD971F;">max_sum</span> = find_max_subarray<span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>low<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>high<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>max_sum<span style="color: #AE81FF;">)</span>


<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">13</span>, -<span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">low</span>, <span style="color: #FD971F;">high</span>, <span style="color: #FD971F;">max_sum</span> = find_max_subarray<span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>low<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>high<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>max_sum<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
7
10
63
0
0
13

</pre>
</div>
</div>
<div id="outline-container-org02fe3fe" class="outline-3">
<h3 id="org02fe3fe"><span class="section-number-3">2.6</span> Stack</h3>
<div class="outline-text-3" id="text-2-6">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Stack</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, size<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.size = size
        <span style="color: #F92672;">self</span>._array = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.size<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">self</span>.top = -<span style="color: #AE81FF;">1</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">isempty</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.top &lt; <span style="color: #AE81FF;">0</span>:
            <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">True</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">False</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">push</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.top == <span style="color: #F92672;">self</span>.size - <span style="color: #AE81FF;">1</span>:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Stack overflow!'</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.top += <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.top<span style="color: #AE81FF;">]</span> = x

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">pop</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.top &lt; <span style="color: #AE81FF;">0</span>:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Stack underflow!'</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.top -= <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.top + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>


<span style="color: #FD971F;">s</span> = Stack<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
s.push<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
s.push<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #AE81FF;">)</span>
s.push<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>s.pop<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>s.pop<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
s.push<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">5</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>s.pop<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>s.pop<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
4
9
5
3

</pre>
</div>
</div>
<div id="outline-container-orgebc021f" class="outline-3">
<h3 id="orgebc021f"><span class="section-number-3">2.7</span> Queue</h3>
<div class="outline-text-3" id="text-2-7">
<ul class="org-ul">
<li>NOTE: use a array of n + 1 length to represent a queue of size n.</li>
<li><p>
Tail is the pointer pointing to the position to enqueue new element.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Queue</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, size<span style="color: #AE81FF;">)</span>:
        <span style="color: #E6DB74;">"""</span>
<span style="color: #E6DB74;">        Use a (n + 1) length array to implement a queue of size n</span>
<span style="color: #E6DB74;">        """</span>
        <span style="color: #F92672;">self</span>.size = size
        <span style="color: #F92672;">self</span>.head = <span style="color: #AE81FF;">0</span>
        <span style="color: #F92672;">self</span>.tail = <span style="color: #AE81FF;">0</span>
        <span style="color: #F92672;">self</span>._array = <span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.size + <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">enqueue</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.head == <span style="color: #F92672;">self</span>.tail + <span style="color: #AE81FF;">1</span> <span style="color: #F92672;">or</span> <span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.head == <span style="color: #AE81FF;">0</span>
                                          <span style="color: #F92672;">and</span> <span style="color: #F92672;">self</span>.tail == <span style="color: #F92672;">self</span>.size<span style="color: #AE81FF;">)</span>:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Queue overflow!"</span><span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.tail<span style="color: #AE81FF;">]</span> = x
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.tail == <span style="color: #F92672;">self</span>.size:
            <span style="color: #F92672;">self</span>.tail = <span style="color: #AE81FF;">0</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.tail += <span style="color: #AE81FF;">1</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Head {}"</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.head<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Tail {}"</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.tail<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">dequeue</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.head == <span style="color: #F92672;">self</span>.tail:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Queue underflow!"</span><span style="color: #AE81FF;">)</span>

        <span style="color: #FD971F;">val</span> = <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.head<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.head == <span style="color: #F92672;">self</span>.size:
            <span style="color: #F92672;">self</span>.head = <span style="color: #AE81FF;">0</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.head += <span style="color: #AE81FF;">1</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Head {}"</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.head<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Tail {}"</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.tail<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> val


<span style="color: #FD971F;">q</span> = Queue<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">5</span><span style="color: #AE81FF;">)</span>
q.enqueue<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
q.enqueue<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>
q.enqueue<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
q.enqueue<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">)</span>
q.enqueue<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">5</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>q.dequeue<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>q.dequeue<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>q.dequeue<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>q.dequeue<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>q.dequeue<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
q.enqueue<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>q.dequeue<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">print(q.dequeue())</span>
</pre>
</div>

<pre class="example">
Head 0
Tail 1
[1, -1, -1, -1, -1, -1]
Head 0
Tail 2
[1, 2, -1, -1, -1, -1]
Head 0
Tail 3
[1, 2, 3, -1, -1, -1]
Head 0
Tail 4
[1, 2, 3, 4, -1, -1]
Head 0
Tail 5
[1, 2, 3, 4, 5, -1]
[1, 2, 3, 4, 5, -1]
Head 1
Tail 5
1
[1, 2, 3, 4, 5, -1]
Head 2
Tail 5
2
[1, 2, 3, 4, 5, -1]
Head 3
Tail 5
3
[1, 2, 3, 4, 5, -1]
Head 4
Tail 5
4
[1, 2, 3, 4, 5, -1]
Head 5
Tail 5
5
9
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-orge495d59" class="outline-3">
<h3 id="orge495d59"><span class="section-number-3">2.8</span> Binary Search</h3>
<div class="outline-text-3" id="text-2-8">
<p>
<a href="Practice/binarySearch.py">py file</a>
</p>

<p>
This is a less cleaner version, but its advantage is that left pointer and
right pointer finally converges to the same position. Sometimes this is
handy when you trying to locate certain position in the end of the loop.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">binarySearch</span><span style="color: #AE81FF;">(</span>nums, target<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> nums:
        <span style="color: #F92672;">return</span> -<span style="color: #AE81FF;">1</span>

    <span style="color: #FD971F;">left</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #FD971F;">right</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>nums<span style="color: #AE81FF;">)</span> - <span style="color: #AE81FF;">1</span>

    <span style="color: #F92672;">while</span> left &lt; right:
        <span style="color: #FD971F;">mid</span> = left + <span style="color: #AE81FF;">(</span>right - left<span style="color: #AE81FF;">)</span> // <span style="color: #AE81FF;">2</span>
        <span style="color: #F92672;">if</span> nums<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">]</span> == target:
            <span style="color: #F92672;">return</span> mid
        <span style="color: #F92672;">elif</span> nums<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">]</span> &lt; target:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">mid could be equal to left, under this situation, left should be</span>
            <span style="color: #75715E;"># </span><span style="color: #75715E;">mid + 1 to force the search on the right hand side. To test this,</span>
            <span style="color: #75715E;"># </span><span style="color: #75715E;">use a test case of [0, 1], search 1</span>
            <span style="color: #FD971F;">left</span> = mid + <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">right</span> = mid

    <span style="color: #F92672;">return</span> left <span style="color: #F92672;">if</span> nums<span style="color: #AE81FF;">[</span>left<span style="color: #AE81FF;">]</span> == target <span style="color: #F92672;">else</span> -<span style="color: #AE81FF;">1</span>

<span style="color: #FD971F;">nums</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">9</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">target</span> = -<span style="color: #AE81FF;">1</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>binarySearch<span style="color: #66D9EF;">(</span>nums, target<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">nums</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">9</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">target</span> = <span style="color: #AE81FF;">4</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>binarySearch<span style="color: #66D9EF;">(</span>nums, target<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">nums</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">target</span> = <span style="color: #AE81FF;">1</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>binarySearch<span style="color: #66D9EF;">(</span>nums, target<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
-1
1
1

</pre>


<p>
NOTE: This version of binary search terminates when r == l - 1, which might not be
suitable for certain situation when we are trying to locate certain value in
the end of the loop.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">binarySearch1</span><span style="color: #AE81FF;">(</span>nums, target<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">l</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #FD971F;">r</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>nums<span style="color: #AE81FF;">)</span> - <span style="color: #AE81FF;">1</span>
    <span style="color: #F92672;">while</span> l &lt;= r:
        <span style="color: #FD971F;">mid</span> = l + <span style="color: #AE81FF;">(</span>r - l<span style="color: #AE81FF;">)</span> // <span style="color: #AE81FF;">2</span>
        <span style="color: #F92672;">if</span> nums<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">]</span> == target:
            <span style="color: #F92672;">return</span> mid
        <span style="color: #F92672;">elif</span> nums<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">]</span> &lt; target:
            <span style="color: #FD971F;">l</span> = mid + <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">r</span> = mid - <span style="color: #AE81FF;">1</span>
    <span style="color: #F92672;">return</span> -<span style="color: #AE81FF;">1</span>

<span style="color: #FD971F;">nums</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">9</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">target</span> = <span style="color: #AE81FF;">6</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>binarySearch1<span style="color: #66D9EF;">(</span>nums, target<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">nums</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">target</span> = <span style="color: #AE81FF;">6</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>binarySearch1<span style="color: #66D9EF;">(</span>nums, target<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">nums</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">target</span> = <span style="color: #AE81FF;">6</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>binarySearch1<span style="color: #66D9EF;">(</span>nums, target<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
None

</pre>
</div>
</div>

<div id="outline-container-org420dd0f" class="outline-3">
<h3 id="org420dd0f"><span class="section-number-3">2.9</span> Linked List</h3>
<div class="outline-text-3" id="text-2-9">
<ul class="org-ul">
<li>Doubly linked list:
O(n) time for search
O(1) time for insert and delete
<ul class="org-ul">
<li>Singly linked list</li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgd8db648" class="outline-4">
<h4 id="orgd8db648"><span class="section-number-4">2.9.1</span> Singly linked list</h4>
<div class="outline-text-4" id="text-2-9-1">
<ul class="org-ul">
<li>Search takes O(n) time</li>
<li>Insert take O(1) time</li>
<li><p>
Delete takes O(n) time
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.key = key
        <span style="color: #F92672;">self</span>.<span style="color: #F92672;">next</span> = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">'Node({})'</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.key<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">SinglyLinkedList</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, head<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.head = head

    <span style="color: #66D9EF;">@classmethod</span>
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">fromList</span><span style="color: #AE81FF;">(</span>cls, arr<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">head</span> = Node<span style="color: #AE81FF;">(</span>arr<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">curr</span> = head
        <span style="color: #F92672;">for</span> k <span style="color: #F92672;">in</span> arr<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span>:<span style="color: #AE81FF;">]</span>:
            curr.<span style="color: #F92672;">next</span> = Node<span style="color: #AE81FF;">(</span>k<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">return</span> cls<span style="color: #AE81FF;">(</span>head<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, k<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">while</span> curr <span style="color: #F92672;">and</span> curr.key != k:
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">return</span> curr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        node.<span style="color: #F92672;">next</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">self</span>.head = node

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">delete</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, k<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">prev</span> = <span style="color: #AE81FF;">None</span>
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">while</span> curr <span style="color: #F92672;">and</span> curr.key != k:
            <span style="color: #FD971F;">prev</span> = curr
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>

        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> curr:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'The key {} does not exist in the list.'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>k<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">if</span> prev:
            prev.<span style="color: #F92672;">next</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.head = curr.<span style="color: #F92672;">next</span>
            curr.<span style="color: #F92672;">next</span> = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">""</span>
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">while</span> curr:
            <span style="color: #F92672;">if</span> s != <span style="color: #E6DB74;">""</span>:
                <span style="color: #FD971F;">s</span> += <span style="color: #E6DB74;">" -&gt; "</span>
            <span style="color: #FD971F;">s</span> += <span style="color: #F92672;">str</span><span style="color: #AE81FF;">(</span>curr.key<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">return</span> s


<span style="color: #FD971F;">lst</span> = SinglyLinkedList.fromList<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
lst.delete<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst<span style="color: #AE81FF;">)</span>
lst.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
lst.delete<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5
Node(2)
1 -&gt; 2 -&gt; 4 -&gt; 5
9 -&gt; 1 -&gt; 2 -&gt; 4 -&gt; 5
None
9 -&gt; 2 -&gt; 4 -&gt; 5

</pre></li>
</ul>
</div>
</div>
<div id="outline-container-orge595321" class="outline-4">
<h4 id="orge595321"><span class="section-number-4">2.9.2</span> Doubly linked list</h4>
<div class="outline-text-4" id="text-2-9-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.key = key
        <span style="color: #F92672;">self</span>.<span style="color: #F92672;">next</span> = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.prev = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">'Node({})'</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.key<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">DoublyLinkedList</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.head = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.tail = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        node.<span style="color: #F92672;">next</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #FD971F;">node.prev</span> = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.head:
            <span style="color: #F92672;">self</span>.head.prev = node

        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> <span style="color: #F92672;">self</span>.tail:
            <span style="color: #F92672;">self</span>.tail = node

        <span style="color: #F92672;">self</span>.head = node

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">while</span> curr <span style="color: #F92672;">and</span> curr.key != key:
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">return</span> curr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">delete</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> node.prev:
            node.prev.<span style="color: #F92672;">next</span> = node.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.head = node.<span style="color: #F92672;">next</span>

        <span style="color: #F92672;">if</span> node.<span style="color: #F92672;">next</span>:
            node.<span style="color: #F92672;">next</span>.prev = node.prev
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.tail = node.prev

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">""</span>
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">while</span> curr:
            <span style="color: #F92672;">if</span> s != <span style="color: #E6DB74;">""</span>:
                <span style="color: #FD971F;">s</span> += <span style="color: #E6DB74;">" &lt;-&gt; "</span>
            <span style="color: #FD971F;">s</span> += <span style="color: #F92672;">str</span><span style="color: #AE81FF;">(</span>curr.key<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">return</span> s


<span style="color: #FD971F;">lst</span> = DoublyLinkedList<span style="color: #AE81FF;">()</span>
lst.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
lst.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
lst.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
lst.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst<span style="color: #AE81FF;">)</span>

lst.delete<span style="color: #AE81FF;">(</span>lst.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst<span style="color: #AE81FF;">)</span>

lst.delete<span style="color: #AE81FF;">(</span>lst.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst.tail<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst.head<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>lst<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
4 &lt;-&gt; 3 &lt;-&gt; 2 &lt;-&gt; 1
4 &lt;-&gt; 3 &lt;-&gt; 2
Node(2)
Node(3)
3 &lt;-&gt; 2

</pre>
</div>
</div>

<div id="outline-container-org522ec14" class="outline-4">
<h4 id="org522ec14"><span class="section-number-4">2.9.3</span> Reverse linked list</h4>
<div class="outline-text-4" id="text-2-9-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.val = val
        <span style="color: #F92672;">self</span>.<span style="color: #F92672;">next</span> = <span style="color: #AE81FF;">None</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">print_list</span><span style="color: #AE81FF;">(</span>head<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">cur</span> = head
    <span style="color: #F92672;">while</span> cur:
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cur.val<span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">cur</span> = cur.<span style="color: #F92672;">next</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">reverse_linked_list</span><span style="color: #AE81FF;">(</span>head<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">cur</span> = head
    <span style="color: #FD971F;">prev</span> = <span style="color: #AE81FF;">None</span>
    <span style="color: #F92672;">while</span> cur:
        <span style="color: #F92672;">next</span> = cur.<span style="color: #F92672;">next</span>
        cur.<span style="color: #F92672;">next</span> = prev
        <span style="color: #FD971F;">prev</span> = cur
        <span style="color: #FD971F;">cur</span> = <span style="color: #F92672;">next</span>
    <span style="color: #F92672;">return</span> prev


<span style="color: #FD971F;">head</span> = Node<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
head.<span style="color: #F92672;">next</span> = Node<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>
head.<span style="color: #F92672;">next</span>.<span style="color: #F92672;">next</span> = Node<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
head.<span style="color: #F92672;">next</span>.<span style="color: #F92672;">next</span>.<span style="color: #F92672;">next</span> = Node<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Before revesing:"</span><span style="color: #AE81FF;">)</span>
print_list<span style="color: #AE81FF;">(</span>head<span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">rhead</span> = reverse_linked_list<span style="color: #AE81FF;">(</span>head<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"After revesing:"</span><span style="color: #AE81FF;">)</span>
print_list<span style="color: #AE81FF;">(</span>rhead<span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Edge Case when head is None"</span><span style="color: #AE81FF;">)</span>
print_list<span style="color: #AE81FF;">(</span>reverse_linked_list<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">None</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Edge Case when head is orphan"</span><span style="color: #AE81FF;">)</span>
print_list<span style="color: #AE81FF;">(</span>reverse_linked_list<span style="color: #66D9EF;">(</span>Node<span style="color: #A6E22E;">(</span><span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Before revesing:
1
2
3
4
After revesing:
4
3
2
1
Edge Case when head is None
Edge Case when head is orphan
1
</pre>
</div>
</div>
</div>
<div id="outline-container-org4b621d4" class="outline-3">
<h3 id="org4b621d4"><span class="section-number-3">2.10</span> Hash table</h3>
<div class="outline-text-3" id="text-2-10">
<p>
Universe of keys is large. The set of keys actually stored may be small relative to the universe of keys.
Consider we maintain a table with m slots, and we have a hash function h: U -&gt; {0, 1, &#x2026;, m - 1}.
Given a key k, we locate T[h[k]]. If there is key collision, which means h[k1] == h[k2]. Then we chain the corresponding values as a linked list.
</p>

<p>
If a hash table uses m slots to store n values, we define the load factor &alpha; = n/m. Then the average search time is O(1 + &alpha;) assuming a uniform hashing function.
</p>

<p>
It is often desired to have keys that are relatively close to map to hash values that are far apart (especially for linear probing).
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.key = key
        <span style="color: #F92672;">self</span>.<span style="color: #F92672;">next</span> = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.prev = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">'Node({})'</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.key<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">DoublyLinkedList</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.head = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.tail = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        node.<span style="color: #F92672;">next</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #FD971F;">node.prev</span> = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.head:
            <span style="color: #F92672;">self</span>.head.prev = node

        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> <span style="color: #F92672;">self</span>.tail:
            <span style="color: #F92672;">self</span>.tail = node

        <span style="color: #F92672;">self</span>.head = node

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">while</span> curr <span style="color: #F92672;">and</span> curr.key != key:
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">return</span> curr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">delete</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> node.prev:
            node.prev.<span style="color: #F92672;">next</span> = node.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.head = node.<span style="color: #F92672;">next</span>

        <span style="color: #F92672;">if</span> node.<span style="color: #F92672;">next</span>:
            node.<span style="color: #F92672;">next</span>.prev = node.prev
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.tail = node.prev

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">""</span>
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.head
        <span style="color: #F92672;">while</span> curr:
            <span style="color: #F92672;">if</span> s != <span style="color: #E6DB74;">""</span>:
                <span style="color: #FD971F;">s</span> += <span style="color: #E6DB74;">" &lt;-&gt; "</span>
            <span style="color: #FD971F;">s</span> += <span style="color: #F92672;">str</span><span style="color: #AE81FF;">(</span>curr.key<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">curr</span> = curr.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">return</span> s


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">divide_hash_fun</span><span style="color: #AE81FF;">(</span>val, m<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">return</span> val % m


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">HashMap</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, size, hash_fun=divide_hash_fun<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.size = size
        <span style="color: #F92672;">self</span>.hash_fun = hash_fun
        <span style="color: #F92672;">self</span>._slots = <span style="color: #AE81FF;">[</span>DoublyLinkedList<span style="color: #66D9EF;">()</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.size<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>._slots<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.hash_fun<span style="color: #66D9EF;">(</span>node.key, <span style="color: #F92672;">self</span>.size<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>.insert<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._slots<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.hash_fun<span style="color: #66D9EF;">(</span>key, <span style="color: #F92672;">self</span>.size<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>.search<span style="color: #AE81FF;">(</span>key<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">delete</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>._slots<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.hash_fun<span style="color: #66D9EF;">(</span>node.key, <span style="color: #F92672;">self</span>.size<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>.delete<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">map</span> = HashMap<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">7</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">map</span>.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">199</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">map</span>.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">10</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">map</span>.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">30</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">map</span>.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">50</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">map</span>.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">10</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">map</span>.delete<span style="color: #AE81FF;">(</span><span style="color: #F92672;">map</span>.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">10</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">map</span>.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">10</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Node(10)
None

</pre>

<ul class="org-ul">
<li>Universal hashing: select hash function randomly in a way that is independent of the keys.</li>
<li>Open addressing: all elements occupy the hash table itself. No linked list. When searching for an element, we systematically examine table slots. The load factor &alpha; = n/m is always less than 1.
<ul class="org-ul">
<li>Linear probing</li>
<li>Quadratic probing</li>
<li>Double Hashing</li>
</ul></li>
<li>Perfect hashing: O(1) search time, 2 levels of hash table. Similar to chained hash table, instead of using linked list, we use a small secondary hash table.
<ul class="org-ul">
<li>We can guarantee there is no collision at the secondary level.</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orga78b174" class="outline-3">
<h3 id="orga78b174"><span class="section-number-3">2.11</span> <span class="todo TODO">TODO</span> Segment Tree</h3>
<div class="outline-text-3" id="text-2-11">
<ul class="org-ul">
<li>Range Sum Query Problem
<ul class="org-ul">
<li>Given an array [-2, 0, 3, -5, 2, -1], support two operations, update and querySumInRange.
<ul class="org-ul">
<li>Naive solution: directly update the i th value. Sum up values one by one when doing the query. Update takes O(1) time, query takes O(n) time.
<ul class="org-ul">
<li>This might be good enough when update happens a lot, but query happens less frequently.</li>
</ul></li>
<li>Precompute the cumulated sum, then query just need to do cumSum[j] - cumSum[i - 1]. Update takes O(n) time, query takes O(1) time.
<ul class="org-ul">
<li>This is good, if update happens much less frequently than query.</li>
</ul></li>
<li>Segment Tree solution. Update and query both take O(logn) time.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org99c2113" class="outline-3">
<h3 id="org99c2113"><span class="section-number-3">2.12</span> Types of binary tree</h3>
<div class="outline-text-3" id="text-2-12">
<ul class="org-ul">
<li>Full binary tree, every node has 0 or 2 children</li>
<li>Complete binary tree, the tree is completely filled except the last right most node. Think about binary heap.</li>
<li>Perfect binary tree. All the interior nodes have two children, and all leaves have the same depth.</li>
</ul>
</div>
</div>
<div id="outline-container-orgd3b3eff" class="outline-3">
<h3 id="orgd3b3eff"><span class="section-number-3">2.13</span> BFS</h3>
<div class="outline-text-3" id="text-2-13">
<p>
<a href="Practice/bfs.py">py file</a>
BFS guarantees the SHORTEST path from the source node to target node.
NOTE: use the color to differentiate nodes!!!! Same as DFS.
Time complexity O(V + E), given a graph G(V, E), with V vertices, and E edges.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> collections <span style="color: #F92672;">import</span> deque


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Vertex</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val, color=<span style="color: #E6DB74;">'white'</span>, distance=-<span style="color: #AE81FF;">1</span>, parent=<span style="color: #AE81FF;">None</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.val = val
        <span style="color: #F92672;">self</span>.color = color
        <span style="color: #F92672;">self</span>.dist = distance
        <span style="color: #F92672;">self</span>.parent = parent

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">"Val: {}, Color: {}, Distance: {}"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span>
            <span style="color: #F92672;">self</span>.val, <span style="color: #F92672;">self</span>.color, <span style="color: #F92672;">self</span>.dist<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Graph</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, adj_list<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.adj_list = adj_list
        <span style="color: #F92672;">self</span>._reset_vertices<span style="color: #AE81FF;">()</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_reset_vertices</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.vertices = <span style="color: #AE81FF;">{</span>n: Vertex<span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span> <span style="color: #F92672;">for</span> n <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.adj_list<span style="color: #AE81FF;">}</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">bfs</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, s<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>._reset_vertices<span style="color: #AE81FF;">()</span>
        <span style="color: #FD971F;">v_s</span> = <span style="color: #F92672;">self</span>.vertices<span style="color: #AE81FF;">[</span>s<span style="color: #AE81FF;">]</span>
        <span style="color: #FD971F;">v_s.color</span> = <span style="color: #E6DB74;">'grey'</span>
        <span style="color: #FD971F;">v_s.dist</span> = <span style="color: #AE81FF;">0</span>

        <span style="color: #FD971F;">queue</span> = deque<span style="color: #AE81FF;">()</span>
        queue.append<span style="color: #AE81FF;">(</span>v_s<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">while</span> queue:
            <span style="color: #FD971F;">cur</span> = queue.popleft<span style="color: #AE81FF;">()</span>
            <span style="color: #FD971F;">cur.color</span> = <span style="color: #E6DB74;">'black'</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cur<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">for</span> n <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.adj_list<span style="color: #AE81FF;">[</span>cur.val<span style="color: #AE81FF;">]</span>:
                <span style="color: #FD971F;">v</span> = <span style="color: #F92672;">self</span>.vertices<span style="color: #AE81FF;">[</span>n<span style="color: #AE81FF;">]</span>
                <span style="color: #F92672;">if</span> v.color == <span style="color: #E6DB74;">'white'</span>:
                    queue.append<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>
                    <span style="color: #FD971F;">v.color</span> = <span style="color: #E6DB74;">'grey'</span>
                    <span style="color: #FD971F;">v.dist</span> = cur.dist + <span style="color: #AE81FF;">1</span>
                    <span style="color: #FD971F;">v.parent</span> = cur


<span style="color: #75715E;"># </span><span style="color: #75715E;">Undirected Graph</span>
<span style="color: #FD971F;">adj_list</span> = <span style="color: #AE81FF;">{</span><span style="color: #AE81FF;">1</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">2</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">3</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">4</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">5</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">}</span>
<span style="color: #FD971F;">g</span> = Graph<span style="color: #AE81FF;">(</span>adj_list<span style="color: #AE81FF;">)</span>
g.bfs<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'-'</span>*<span style="color: #AE81FF;">50</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">Directed cyclic Graph</span>
<span style="color: #FD971F;">adj_list</span> = <span style="color: #AE81FF;">{</span><span style="color: #AE81FF;">1</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">2</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">3</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">4</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">5</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">}</span>
<span style="color: #FD971F;">g</span> = Graph<span style="color: #AE81FF;">(</span>adj_list<span style="color: #AE81FF;">)</span>
g.bfs<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'-'</span>*<span style="color: #AE81FF;">50</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">Directed acyclic Graph</span>
<span style="color: #FD971F;">adj_list</span> = <span style="color: #AE81FF;">{</span><span style="color: #AE81FF;">1</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">2</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">3</span>: <span style="color: #66D9EF;">[]</span>,
            <span style="color: #AE81FF;">4</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">5</span>: <span style="color: #66D9EF;">[]</span><span style="color: #AE81FF;">}</span>
<span style="color: #FD971F;">g</span> = Graph<span style="color: #AE81FF;">(</span>adj_list<span style="color: #AE81FF;">)</span>
g.bfs<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'-'</span>*<span style="color: #AE81FF;">50</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">Directed acyclic Graph</span>
<span style="color: #FD971F;">adj_list</span> = <span style="color: #AE81FF;">{</span><span style="color: #AE81FF;">1</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">2</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">3</span>: <span style="color: #66D9EF;">[]</span>,
            <span style="color: #AE81FF;">4</span>: <span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">]</span>,
            <span style="color: #AE81FF;">5</span>: <span style="color: #66D9EF;">[]</span><span style="color: #AE81FF;">}</span>
<span style="color: #FD971F;">g</span> = Graph<span style="color: #AE81FF;">(</span>adj_list<span style="color: #AE81FF;">)</span>
g.bfs<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Val: 1, Color: black, Distance: 0
Val: 2, Color: black, Distance: 1
Val: 5, Color: black, Distance: 1
Val: 3, Color: black, Distance: 2
Val: 4, Color: black, Distance: 2
--------------------------------------------------
Val: 1, Color: black, Distance: 0
Val: 2, Color: black, Distance: 1
Val: 4, Color: black, Distance: 2
Val: 3, Color: black, Distance: 3
Val: 5, Color: black, Distance: 3
--------------------------------------------------
Val: 1, Color: black, Distance: 0
Val: 2, Color: black, Distance: 1
Val: 5, Color: black, Distance: 1
Val: 3, Color: black, Distance: 2
Val: 4, Color: black, Distance: 2
--------------------------------------------------
Val: 4, Color: black, Distance: 0
Val: 3, Color: black, Distance: 1
Val: 5, Color: black, Distance: 1
</pre>
</div>
</div>

<div id="outline-container-orgba5a7e5" class="outline-3">
<h3 id="orgba5a7e5"><span class="section-number-3">2.14</span> DFS</h3>
<div class="outline-text-3" id="text-2-14">
<p>
<a href="Practice/dfs.py">py file</a>
Parenthesis theorem:
Given two vertices in the graph u and v, u.d denotes the discover time of u,
u.f denotes the finish time of u.
</p>
<ul class="org-ul">
<li>If the interval [u.d, u.f] and [v.d, v.f] are entirely disjoint, and
neither u nor v is a descendant of the other in the depth-first forest.</li>
<li>If the interval [u.d, u.f] is contained in [v.d, v.f], the u is a descendant of v.</li>
<li><p>
If the interval [v.d, v.f] is contained in [u.d, u.f], the v is a descendant of v.
</p>

<p>
Classification of edges:
</p>
<ul class="org-ul">
<li>Tree edges, edges in the depth first forest. Edge (u, v) is a tree edge if v was first discovered by exploring (u, v).</li>
<li>Back edges, edges (u, v) connecting a vertex u with its ancestor v in a depth-first tree. Including self loops in the directed graph, where a vertex is connecting with itself.</li>
<li>Forward edges, nontree edges (u, v) connecting a vertex u to a descendant v in a depth-first tree.</li>
<li><p>
Cross edges, all the other edges.
</p>

<p>
DFS has enough information to classify some of the edges it encounters.
When we first explore an edge (u, v), the color of v tells us something about the edge
</p>
<ul class="org-ul">
<li>WHITE indicates a tree edge</li>
<li>GRAY indicates a back edge. NOTE: this is critical to determine whether the graph is cyclic or not.</li>
<li>BLACK indicates a forward or cross edge.</li>
</ul>

<p>
For undirected graph, every edge is either a tree edge or a back edge.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> datetime <span style="color: #F92672;">import</span> datetime


<span style="color: #FD971F;">time</span> = <span style="color: #AE81FF;">0</span>  <span style="color: #75715E;"># </span><span style="color: #75715E;">global timer</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Vertex</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val, color=<span style="color: #E6DB74;">'white'</span>, parent=<span style="color: #AE81FF;">None</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.val = val
        <span style="color: #F92672;">self</span>.color = color
        <span style="color: #F92672;">self</span>.parent = parent

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">"(Val: {}, Color: {})"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.val, <span style="color: #F92672;">self</span>.color<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Graph</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.adj = <span style="color: #AE81FF;">{}</span>
        <span style="color: #F92672;">self</span>.nodes = <span style="color: #AE81FF;">{}</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addNode</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">node</span> = Vertex<span style="color: #AE81FF;">(</span>val<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.nodes<span style="color: #AE81FF;">[</span>val<span style="color: #AE81FF;">]</span> = node
        <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">[]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addMultiNodes</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val_list<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">for</span> v <span style="color: #F92672;">in</span> val_list:
            <span style="color: #F92672;">self</span>.addNode<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addEdge</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u, v<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">u_node</span> = <span style="color: #F92672;">self</span>.nodes<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>
        <span style="color: #FD971F;">v_node</span> = <span style="color: #F92672;">self</span>.nodes<span style="color: #AE81FF;">[</span>v<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>u_node<span style="color: #AE81FF;">]</span>.append<span style="color: #AE81FF;">(</span>v_node<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addMultiEdges</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, edge_list<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">for</span> e <span style="color: #F92672;">in</span> edge_list:
            <span style="color: #F92672;">self</span>.addEdge<span style="color: #AE81FF;">(</span>e<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span>, e<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">dfs</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">global</span> time
        <span style="color: #FD971F;">time</span> = <span style="color: #AE81FF;">0</span>
        <span style="color: #F92672;">for</span> u <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.nodes.values<span style="color: #AE81FF;">()</span>:
            <span style="color: #F92672;">if</span> u.color == <span style="color: #E6DB74;">'white'</span>:
                <span style="color: #F92672;">self</span>.dfs_visit<span style="color: #AE81FF;">(</span>u<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">dfs_visit</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">global</span> time
        <span style="color: #FD971F;">time</span> += <span style="color: #AE81FF;">1</span>
        <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'gray'</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'At time {}, Discovered node: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>time, u<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">for</span> v <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">if</span> v.color == <span style="color: #E6DB74;">'white'</span>:
                <span style="color: #F92672;">self</span>.dfs_visit<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>
                <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'black'</span>
                <span style="color: #FD971F;">time</span> += <span style="color: #AE81FF;">1</span>
                <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'At time {}, Finish visiting node: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>time, u<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>


<span style="color: #FD971F;">g</span> = Graph<span style="color: #AE81FF;">()</span>
g.addMultiNodes<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span><span style="color: #E6DB74;">'s'</span>, <span style="color: #E6DB74;">'z'</span>, <span style="color: #E6DB74;">'y'</span>, <span style="color: #E6DB74;">'x'</span>, <span style="color: #E6DB74;">'w'</span>, <span style="color: #E6DB74;">'t'</span>, <span style="color: #E6DB74;">'v'</span>, <span style="color: #E6DB74;">'u'</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
g.addMultiEdges<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span><span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'s'</span>, <span style="color: #E6DB74;">'z'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'z'</span>, <span style="color: #E6DB74;">'y'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'y'</span>, <span style="color: #E6DB74;">'x'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'z'</span>, <span style="color: #E6DB74;">'w'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'w'</span>, <span style="color: #E6DB74;">'x'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'x'</span>, <span style="color: #E6DB74;">'z'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'s'</span>, <span style="color: #E6DB74;">'w'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'v'</span>, <span style="color: #E6DB74;">'s'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'v'</span>, <span style="color: #E6DB74;">'w'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'t'</span>, <span style="color: #E6DB74;">'v'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'t'</span>, <span style="color: #E6DB74;">'u'</span><span style="color: #A6E22E;">]</span>,
                 <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'u'</span>, <span style="color: #E6DB74;">'v'</span><span style="color: #A6E22E;">]</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
g.dfs<span style="color: #AE81FF;">()</span>
</pre>
</div>

<pre class="example">
At time 1, Discovered node: (Val: s, Color: gray)
At time 2, Discovered node: (Val: z, Color: gray)
At time 3, Discovered node: (Val: y, Color: gray)
At time 4, Discovered node: (Val: x, Color: gray)
At time 5, Finish visiting node: (Val: y, Color: black)
At time 6, Finish visiting node: (Val: z, Color: black)
At time 7, Discovered node: (Val: w, Color: gray)
At time 8, Finish visiting node: (Val: z, Color: black)
At time 9, Finish visiting node: (Val: s, Color: black)
At time 10, Discovered node: (Val: u, Color: gray)
At time 11, Discovered node: (Val: v, Color: gray)
At time 12, Finish visiting node: (Val: u, Color: black)
At time 13, Discovered node: (Val: t, Color: gray)
</pre>

<p>
The results shows the parenthesis theorem clearly: (s (z (y (x x) y) (w w) z) s) (t (v v) (u u) t).
</p></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org80fbb24" class="outline-3">
<h3 id="org80fbb24"><span class="section-number-3">2.15</span> Topological Sort</h3>
<div class="outline-text-3" id="text-2-15">
<p>
Topological sort can only be performed in a directed acyclic graph (DAG). A
topological sort of a dag G = (V, E) is a linear ordering of all its vertices
such that if G contains an edge (u, v), the u appears before v in the
ordering.
</p>

<p>
Topological sort pseudo code:
</p>
<ul class="org-ul">
<li>call DFS(G)</li>
<li>as each vertex is finished, insert it in front of a linked list</li>
<li><p>
return the linked list
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">import</span> logging
<span style="color: #F92672;">from</span> collections <span style="color: #F92672;">import</span> deque

<span style="color: #FD971F;">logger</span> = logging.getLogger<span style="color: #AE81FF;">(</span><span style="color: #F92672;">__name__</span><span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Vertex</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val, color=<span style="color: #E6DB74;">'white'</span>, parent=<span style="color: #AE81FF;">None</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.val = val
        <span style="color: #F92672;">self</span>.color = color
        <span style="color: #F92672;">self</span>.parent = parent

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">"Val: {}, Color: {}"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.val, <span style="color: #F92672;">self</span>.color<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Graph</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.adj = <span style="color: #AE81FF;">{}</span>
        <span style="color: #F92672;">self</span>.nodes = <span style="color: #AE81FF;">{}</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addNode</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">node</span> = Vertex<span style="color: #AE81FF;">(</span>val<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.nodes<span style="color: #AE81FF;">[</span>val<span style="color: #AE81FF;">]</span> = node
        <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">[]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addMultiNodes</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val_list<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">for</span> v <span style="color: #F92672;">in</span> val_list:
            <span style="color: #F92672;">self</span>.addNode<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addEdge</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u, v<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">u_node</span> = <span style="color: #F92672;">self</span>.nodes<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>
        <span style="color: #FD971F;">v_node</span> = <span style="color: #F92672;">self</span>.nodes<span style="color: #AE81FF;">[</span>v<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>u_node<span style="color: #AE81FF;">]</span>.append<span style="color: #AE81FF;">(</span>v_node<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">addMultiEdges</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, edge_list<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">for</span> e <span style="color: #F92672;">in</span> edge_list:
            <span style="color: #F92672;">self</span>.addEdge<span style="color: #AE81FF;">(</span>e<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span>, e<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">dfs</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>._reset_nodes<span style="color: #AE81FF;">()</span>
        <span style="color: #F92672;">for</span> u <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.nodes.values<span style="color: #AE81FF;">()</span>:
            <span style="color: #F92672;">if</span> u.color == <span style="color: #E6DB74;">'white'</span>:
                <span style="color: #F92672;">self</span>.dfs_visit<span style="color: #AE81FF;">(</span>u<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">dfs_visit</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'gray'</span>
        logger.info<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Discovered node: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>u<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">for</span> v <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">if</span> v.color == <span style="color: #E6DB74;">'white'</span>:
                <span style="color: #F92672;">self</span>.parent = u
                <span style="color: #F92672;">self</span>.dfs_visit<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>
                <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'black'</span>
                logger.info<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Finish visiting node: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>u<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_reset_nodes</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">for</span> u <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.nodes.values<span style="color: #AE81FF;">()</span>:
            <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'white'</span>
            <span style="color: #FD971F;">u.parent</span> = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">isDAG</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>._reset_nodes<span style="color: #AE81FF;">()</span>
        <span style="color: #F92672;">for</span> u <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.nodes.values<span style="color: #AE81FF;">()</span>:
            <span style="color: #F92672;">if</span> u.color == <span style="color: #E6DB74;">'white'</span> <span style="color: #F92672;">and</span> <span style="color: #F92672;">not</span> <span style="color: #F92672;">self</span>.isDAGTree<span style="color: #AE81FF;">(</span>u<span style="color: #AE81FF;">)</span>:
                <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">False</span>
        <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">True</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">isDAGTree</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'gray'</span>
        <span style="color: #F92672;">for</span> v <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>:
            logger.info<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Discovered node: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>v<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">if</span> v.color == <span style="color: #E6DB74;">'gray'</span>:
                <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">False</span>
            <span style="color: #F92672;">elif</span> v.color == <span style="color: #E6DB74;">'white'</span> <span style="color: #F92672;">and</span> <span style="color: #F92672;">not</span> <span style="color: #F92672;">self</span>.isDAGTree<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>:
                <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">False</span>
            <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'black'</span>
        <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">True</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">topo_sort</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>._reset_nodes<span style="color: #AE81FF;">()</span>
        <span style="color: #FD971F;">sorted_list</span> = deque<span style="color: #AE81FF;">()</span>
        <span style="color: #F92672;">for</span> u <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.nodes.values<span style="color: #AE81FF;">()</span>:
            <span style="color: #F92672;">if</span> u.color == <span style="color: #E6DB74;">'white'</span>:
                <span style="color: #F92672;">self</span>.topo_sort_helper<span style="color: #AE81FF;">(</span>u, sorted_list<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> sorted_list

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">topo_sort_helper</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u, sorted_list<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'gray'</span>
        <span style="color: #F92672;">for</span> v <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.adj<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">if</span> v.color == <span style="color: #E6DB74;">'white'</span>:
                <span style="color: #FD971F;">v.parent</span> = u
                <span style="color: #F92672;">self</span>.topo_sort_helper<span style="color: #AE81FF;">(</span>v, sorted_list<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">elif</span> v.color == <span style="color: #E6DB74;">'gray'</span>:
                <span style="color: #66D9EF;">ValueError</span><span style="color: #AE81FF;">(</span>
                    <span style="color: #E6DB74;">'The graph has cycle. Cannot perform topological sort!'</span><span style="color: #AE81FF;">)</span>
                <span style="color: #FD971F;">u.color</span> = <span style="color: #E6DB74;">'black'</span>
                sorted_list.appendleft<span style="color: #AE81FF;">(</span>u.val<span style="color: #AE81FF;">)</span>


<span style="color: #FD971F;">g</span> = Graph<span style="color: #AE81FF;">()</span>
g.addMultiNodes<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span>
    <span style="color: #E6DB74;">'undershorts'</span>, <span style="color: #E6DB74;">'pants'</span>, <span style="color: #E6DB74;">'belt'</span>, <span style="color: #E6DB74;">'shirt'</span>, <span style="color: #E6DB74;">'tie'</span>, <span style="color: #E6DB74;">'tie'</span>, <span style="color: #E6DB74;">'jacket'</span>, <span style="color: #E6DB74;">'socks'</span>,
    <span style="color: #E6DB74;">'shoes'</span>, <span style="color: #E6DB74;">'watch'</span>
<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>

g.addMultiEdges<span style="color: #AE81FF;">(</span>
    <span style="color: #66D9EF;">[</span><span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'undershorts'</span>, <span style="color: #E6DB74;">'pants'</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'pants'</span>, <span style="color: #E6DB74;">'belt'</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'belt'</span>, <span style="color: #E6DB74;">'jacket'</span><span style="color: #A6E22E;">]</span>,
     <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'shirt'</span>, <span style="color: #E6DB74;">'belt'</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'shirt'</span>, <span style="color: #E6DB74;">'tie'</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'tie'</span>, <span style="color: #E6DB74;">'jacket'</span><span style="color: #A6E22E;">]</span>,
     <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'undershorts'</span>, <span style="color: #E6DB74;">'shoes'</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'pants'</span>, <span style="color: #E6DB74;">'shoes'</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #E6DB74;">'socks'</span>, <span style="color: #E6DB74;">'shoes'</span><span style="color: #A6E22E;">]</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>g.topo_sort<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
deque(['undershorts', 'pants', 'pants', 'socks', 'tie'])

</pre>

<p>
Here is a simpler version. Good as an interview template.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> collections <span style="color: #F92672;">import</span> deque


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">buildDirectedGraph</span><span style="color: #AE81FF;">(</span>numNodes, edges<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">graph</span> = <span style="color: #AE81FF;">{</span>i: <span style="color: #F92672;">set</span><span style="color: #66D9EF;">()</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>numNodes<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">}</span>
    <span style="color: #F92672;">for</span> u, v <span style="color: #F92672;">in</span> edges:
        graph<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>.add<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">return</span> graph


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">topo_sort</span><span style="color: #AE81FF;">(</span>graph<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">dfs</span><span style="color: #AE81FF;">(</span>graph, node, visited, discovered, res<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> node <span style="color: #F92672;">in</span> visited:
            <span style="color: #F92672;">return</span>

        <span style="color: #F92672;">if</span> node <span style="color: #F92672;">in</span> discovered:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span>
                <span style="color: #E6DB74;">'The graph has a cycle. It is not topologically sortable.'</span><span style="color: #AE81FF;">)</span>

        discovered.add<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">for</span> nei <span style="color: #F92672;">in</span> graph<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span>:
            dfs<span style="color: #AE81FF;">(</span>graph, nei, visited, discovered, res<span style="color: #AE81FF;">)</span>

        discovered.remove<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
        visited.add<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
        res.appendleft<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>

    <span style="color: #FD971F;">res</span> = deque<span style="color: #AE81FF;">()</span>
    <span style="color: #FD971F;">visited</span> = <span style="color: #F92672;">set</span><span style="color: #AE81FF;">()</span>  <span style="color: #75715E;"># </span><span style="color: #75715E;">nodes that are finished visiting</span>
    <span style="color: #FD971F;">discovered</span> = <span style="color: #F92672;">set</span><span style="color: #AE81FF;">()</span>  <span style="color: #75715E;"># </span><span style="color: #75715E;">nodes that are discovered by dfs but not yet finished</span>
    <span style="color: #F92672;">for</span> node <span style="color: #F92672;">in</span> graph:
        dfs<span style="color: #AE81FF;">(</span>graph, node, visited, discovered, res<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> res


<span style="color: #75715E;"># </span><span style="color: #75715E;">graph = buildDirectedGraph(2, [[1, 0], [0, 1]])</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">res = topo_sort(graph)</span>

<span style="color: #FD971F;">graph</span> = buildDirectedGraph<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span>, <span style="color: #66D9EF;">[</span><span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">2</span><span style="color: #A6E22E;">]</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
<span style="color: #FD971F;">res</span> = topo_sort<span style="color: #AE81FF;">(</span>graph<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>res<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
deque([3, 2, 1, 0])

</pre>

<p>
Kahn's algorithm, something like BFS, queue is used.
</p>
<ul class="org-ul">
<li>Create the indegree map of the graph</li>
<li>Append the nodes with 0 indegree to the queue</li>
<li>while the queue is not empty, dequeue and get one node, count += 1, stack append the node. for all its neighbors, decrease the indegree by 1, and append the neighbors whose indegree is 0.</li>
<li><p>
if count != the total number of nodes, then the graph is not DAG. Otherwise return the stack. The stack is topologically sorted.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> collections <span style="color: #F92672;">import</span> deque


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">buildDirectedGraph</span><span style="color: #AE81FF;">(</span>numNodes, edges<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">graph</span> = <span style="color: #AE81FF;">{</span>i: <span style="color: #F92672;">set</span><span style="color: #66D9EF;">()</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>numNodes<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">}</span>
    <span style="color: #F92672;">for</span> u, v <span style="color: #F92672;">in</span> edges:
        graph<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>.add<span style="color: #AE81FF;">(</span>v<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> graph


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">topo_sort</span><span style="color: #AE81FF;">(</span>graph<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">indegree</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> * <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>graph<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">for</span> neighbors <span style="color: #F92672;">in</span> graph.values<span style="color: #AE81FF;">()</span>:
        <span style="color: #F92672;">for</span> nei <span style="color: #F92672;">in</span> neighbors:
            <span style="color: #FD971F;">indegree</span><span style="color: #AE81FF;">[</span>nei<span style="color: #AE81FF;">]</span> += <span style="color: #AE81FF;">1</span>

    <span style="color: #FD971F;">q</span> = deque<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span>n <span style="color: #F92672;">for</span> n <span style="color: #F92672;">in</span> graph <span style="color: #F92672;">if</span> indegree<span style="color: #A6E22E;">[</span>n<span style="color: #A6E22E;">]</span> == <span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">res</span> = <span style="color: #AE81FF;">[]</span>
    <span style="color: #F92672;">while</span> q:
        <span style="color: #FD971F;">node</span> = q.popleft<span style="color: #AE81FF;">()</span>
        res.append<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">for</span> nei <span style="color: #F92672;">in</span> graph<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span>:
            <span style="color: #FD971F;">indegree</span><span style="color: #AE81FF;">[</span>nei<span style="color: #AE81FF;">]</span> -= <span style="color: #AE81FF;">1</span>
            <span style="color: #F92672;">if</span> indegree<span style="color: #AE81FF;">[</span>nei<span style="color: #AE81FF;">]</span> == <span style="color: #AE81FF;">0</span>:
                q.append<span style="color: #AE81FF;">(</span>nei<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">if</span> <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>res<span style="color: #AE81FF;">)</span> &lt; <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>graph<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'The graph has a cycle. It is not topologically sortable.'</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> res


<span style="color: #75715E;"># </span><span style="color: #75715E;">graph = buildDirectedGraph(2, [[1, 0], [0, 1]])</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">res = topo_sort(graph)</span>

<span style="color: #FD971F;">graph</span> = buildDirectedGraph<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span>, <span style="color: #66D9EF;">[</span><span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">2</span><span style="color: #A6E22E;">]</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
<span style="color: #FD971F;">res</span> = topo_sort<span style="color: #AE81FF;">(</span>graph<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>res<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[3, 1, 2, 0]

</pre></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org17bac4a" class="outline-3">
<h3 id="org17bac4a"><span class="section-number-3">2.16</span> Strongly connected components</h3>
<div class="outline-text-3" id="text-2-16">
<p>
In a strongly connected component, every pair of vertices are reachable from each other.
</p>

<ul class="org-ul">
<li>call DFS(G) to compute the finishing times for each vertex</li>
<li>compute G<sup>T</sup>, G transpose (reverse every edge)</li>
<li>call DFS(G<sup>T</sup>), but in the main loop of DFS, consider vertices in order of decreasing finishing time u.f obtained in the first step.</li>
<li>output the vertices of each tree in the depth-first forest obtained in step 3</li>
</ul>
</div>
</div>

<div id="outline-container-orge2e58d5" class="outline-3">
<h3 id="orge2e58d5"><span class="section-number-3">2.17</span> Binary Search Tree</h3>
<div class="outline-text-3" id="text-2-17">
<ul class="org-ul">
<li>If node y is in the left subtree of x, then y.key &lt;= x.key.</li>
<li>If node y is in the right subtree of x, then y.key &gt;= x.key.</li>
<li>Inorder tree walk: print left tree -&gt; print the node itself -&gt; print the right tree</li>
<li>Preorder tree walk: print the root -&gt; print the subtrees</li>
<li><p>
Post order tree walk: print the subtrees -&gt; print the root
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> collections <span style="color: #F92672;">import</span> deque


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.key = x
        <span style="color: #F92672;">self</span>.left = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.right = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.parent = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">"Node({})"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.key<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">BinarySearchTree</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.root = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">inorder_tree_walk</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>._inorder_tree_walk_helper<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.root<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_inorder_tree_walk_helper</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> node:
            <span style="color: #F92672;">self</span>._inorder_tree_walk_helper<span style="color: #AE81FF;">(</span>node.left<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>node.key<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">self</span>._inorder_tree_walk_helper<span style="color: #AE81FF;">(</span>node.right<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._search_helper<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.root, key<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_search_helper</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> node <span style="color: #F92672;">or</span> node.key == key:
            <span style="color: #F92672;">return</span> node

        <span style="color: #F92672;">if</span> key &lt; node.key:
            <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._search_helper<span style="color: #AE81FF;">(</span>node.left, key<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._search_helper<span style="color: #AE81FF;">(</span>node.right, key<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">iterative_search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.root
        <span style="color: #F92672;">while</span> curr <span style="color: #F92672;">and</span> curr.key != key:
            <span style="color: #F92672;">if</span> key &lt; curr.key:
                <span style="color: #FD971F;">curr</span> = curr.left
            <span style="color: #F92672;">else</span>:
                <span style="color: #FD971F;">curr</span> = curr.right
        <span style="color: #F92672;">return</span> curr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">maximum</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._maximum<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.root<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_maximum</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = node
        <span style="color: #F92672;">while</span> curr.right:
            <span style="color: #FD971F;">curr</span> = curr.right
        <span style="color: #F92672;">return</span> curr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">minimum</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._minimum<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.root<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_minimum</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = node
        <span style="color: #F92672;">while</span> curr.left:
            <span style="color: #FD971F;">curr</span> = curr.left
        <span style="color: #F92672;">return</span> curr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">p</span> = <span style="color: #AE81FF;">None</span>
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.root
        <span style="color: #F92672;">while</span> curr:
            <span style="color: #FD971F;">p</span> = curr
            <span style="color: #F92672;">if</span> node.key &lt; curr.key:
                <span style="color: #FD971F;">curr</span> = curr.left
            <span style="color: #F92672;">else</span>:
                <span style="color: #FD971F;">curr</span> = curr.right
                <span style="color: #FD971F;">node.parent</span> = p
        <span style="color: #F92672;">if</span> p:
            <span style="color: #F92672;">if</span> node.key &lt; p.key:
                <span style="color: #FD971F;">p.left</span> = node
            <span style="color: #F92672;">else</span>:
                <span style="color: #FD971F;">p.right</span> = node
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">self</span>.root = node

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">successor</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #E6DB74;">"""</span>
<span style="color: #E6DB74;">        Find the successor of the sorted array in the inorder traversal</span>
<span style="color: #E6DB74;">        """</span>
        <span style="color: #F92672;">if</span> node.right:
            <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._minimum<span style="color: #AE81FF;">(</span>node.right<span style="color: #AE81FF;">)</span>

        <span style="color: #FD971F;">parent_node</span> = node.parent
        <span style="color: #F92672;">while</span> parent_node <span style="color: #F92672;">and</span> parent_node.left != node:
            <span style="color: #FD971F;">node</span> = parent_node
            <span style="color: #FD971F;">parent_node</span> = node.parent
        <span style="color: #F92672;">return</span> parent_node

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">predecessor</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> node.left:
            <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._maximum<span style="color: #AE81FF;">(</span>node.left<span style="color: #AE81FF;">)</span>

        <span style="color: #FD971F;">parent_node</span> = node.parent
        <span style="color: #F92672;">while</span> parent_node <span style="color: #F92672;">and</span> parent_node.right != node:
            <span style="color: #FD971F;">node</span> = parent_node
            <span style="color: #FD971F;">parent_node</span> = node.parent
        <span style="color: #F92672;">return</span> parent_node

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">transplant</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u, v<span style="color: #AE81FF;">)</span>:
        <span style="color: #E6DB74;">"""Replace the subtree rooted at u with the subtree rooted at v</span>
<span style="color: #E6DB74;">        </span><span style="color: #d0bf8f;">NOTE</span><span style="color: #E6DB74;">: u must not be None, but v can be None</span>
<span style="color: #E6DB74;">        """</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> u.parent:
            <span style="color: #F92672;">self</span>.root = v
        <span style="color: #F92672;">elif</span> u.parent.left == u:
            <span style="color: #FD971F;">u.parent.left</span> = v
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">u.parent.right</span> = v

        <span style="color: #F92672;">if</span> v:
            <span style="color: #FD971F;">v.parent</span> = u.parent

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">delete</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #E6DB74;">"""Delete the node, assuming node cannot be None</span>
<span style="color: #E6DB74;">        """</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> node.left:
            <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>node, node.right<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">elif</span> <span style="color: #F92672;">not</span> node.right:
            <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>node, node.left<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">suc_node</span> = <span style="color: #F92672;">self</span>.successor<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">if</span> suc_node.parent != node:
                <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>suc_node, suc_node.right<span style="color: #AE81FF;">)</span>
                <span style="color: #FD971F;">suc_node.right</span> = node.right
                <span style="color: #FD971F;">suc_node.right.parent</span> = suc_node
            <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>node, suc_node<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">suc_node.left</span> = node.left
            <span style="color: #FD971F;">suc_node.left.parent</span> = suc_node

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_print</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node, indent<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">""</span>
        <span style="color: #F92672;">if</span> node:
            <span style="color: #FD971F;">s</span> = indent + <span style="color: #F92672;">str</span><span style="color: #AE81FF;">(</span>node.key<span style="color: #AE81FF;">)</span> + <span style="color: #E6DB74;">"\n"</span>
            <span style="color: #F92672;">if</span> node.left:
                <span style="color: #FD971F;">s</span> += <span style="color: #F92672;">self</span>._print<span style="color: #AE81FF;">(</span>node.left, indent + <span style="color: #E6DB74;">"|---"</span><span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">if</span> node.right:
                <span style="color: #FD971F;">s</span> += <span style="color: #F92672;">self</span>._print<span style="color: #AE81FF;">(</span>node.right, indent + <span style="color: #E6DB74;">"|---"</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> s

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> <span style="color: #F92672;">self</span>.root:
            <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">""</span>
        <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">""</span>
        <span style="color: #FD971F;">curr_level</span> = <span style="color: #AE81FF;">[]</span>
        curr_level.append<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.root<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">while</span> curr_level:
            <span style="color: #FD971F;">next_level</span> = <span style="color: #AE81FF;">[]</span>
            <span style="color: #F92672;">for</span> n <span style="color: #F92672;">in</span> curr_level:
                <span style="color: #FD971F;">s</span> += <span style="color: #F92672;">str</span><span style="color: #AE81FF;">(</span>n.key<span style="color: #AE81FF;">)</span> + <span style="color: #E6DB74;">" "</span>
                <span style="color: #F92672;">if</span> n.left:
                    next_level.append<span style="color: #AE81FF;">(</span>n.left<span style="color: #AE81FF;">)</span>
                <span style="color: #F92672;">if</span> n.right:
                    next_level.append<span style="color: #AE81FF;">(</span>n.right<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">s</span> += <span style="color: #E6DB74;">"\n"</span>
            <span style="color: #FD971F;">curr_level</span> = next_level
        <span style="color: #F92672;">return</span> s


<span style="color: #FD971F;">t</span> = BinarySearchTree<span style="color: #AE81FF;">()</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">12</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">18</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">15</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">19</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

t.inorder_tree_walk<span style="color: #AE81FF;">()</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.iterative_search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.minimum<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.maximum<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.successor<span style="color: #66D9EF;">(</span>t.search<span style="color: #A6E22E;">(</span><span style="color: #AE81FF;">9</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.predecessor<span style="color: #66D9EF;">(</span>t.search<span style="color: #A6E22E;">(</span><span style="color: #AE81FF;">9</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.delete<span style="color: #AE81FF;">(</span>t.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">12</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
2
5
9
12
15
18
19
Node(9)
Node(9)
Node(2)
Node(19)
None
Node(5)
12 
5 18 
2 9 15 19 

15 
5 
2 9 

</pre>

<ul class="org-ul">
<li>Randomly built binary search tree: each of the n! permutations of the input keys is equally likely (it is different from insert the n keys equally likely each time).</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org91369cb" class="outline-3">
<h3 id="org91369cb"><span class="section-number-3">2.18</span> Red-Black Tree</h3>
<div class="outline-text-3" id="text-2-18">
<p>
Red-Black Properties:
</p>
<ul class="org-ul">
<li>Every node is either red or black.</li>
<li>The root is black.</li>
<li>Every leaf (NIL) is black.</li>
<li>If a node is red, then both its children are black.</li>
<li><p>
For each node, all simple paths from the node to descendant leaves contain the same number of black nodes.
</p>

<p>
Black-height of node x: the number of black nodes from the node x (not including x) to a leaf.
</p>

<p>
Lemma: A red-black tree with n internal nodes has height at most 2lg(n+1).
</p>

<p>
Rotation:
</p>


<div class="figure">
<p><img src="beforeRotation.png" alt="beforeRotation.png" />
</p>
</div>

<p>
After Right-Rotate is performed,
</p>

<div class="figure">
<p><img src="afterRotation.png" alt="afterRotation.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span>:
    <span style="color: #FD971F;">BLACK</span> = <span style="color: #E6DB74;">"BLACK"</span>
    <span style="color: #FD971F;">RED</span> = <span style="color: #E6DB74;">"RED"</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.key = key
        <span style="color: #F92672;">self</span>.left = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.right = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.color = <span style="color: #F92672;">self</span>.BLACK
        <span style="color: #F92672;">self</span>.parent = <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">"Node(key={}, color={})"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.key, <span style="color: #F92672;">self</span>.color<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">RedBlackTree</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.nil = Node<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">None</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.root = <span style="color: #F92672;">self</span>.nil

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">left_rotate</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">Assuming x.right is not self.nil</span>
        <span style="color: #FD971F;">y</span> = x.right             <span style="color: #75715E;"># </span><span style="color: #75715E;">set y</span>
        <span style="color: #FD971F;">x.right</span> = y.left        <span style="color: #75715E;"># </span><span style="color: #75715E;">turn y's left subtree into x's right subtree</span>
        <span style="color: #F92672;">if</span> y.left != <span style="color: #F92672;">self</span>.nil:  <span style="color: #75715E;"># </span><span style="color: #75715E;">no need to link y.left's parent if it is a sentinel</span>
            <span style="color: #FD971F;">y.left.parent</span> = x
        <span style="color: #FD971F;">y.parent</span> = x.parent     <span style="color: #75715E;"># </span><span style="color: #75715E;">link x's parent to y</span>
        <span style="color: #F92672;">if</span> x.parent == <span style="color: #F92672;">self</span>.nil:
            <span style="color: #F92672;">self</span>.root = y
        <span style="color: #F92672;">elif</span> x == x.parent.left:
            <span style="color: #FD971F;">x.parent.left</span> = y
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">x.parent.right</span> = y
        <span style="color: #FD971F;">y.left</span> = x              <span style="color: #75715E;"># </span><span style="color: #75715E;">put x into y's left</span>
        <span style="color: #FD971F;">x.parent</span> = y

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">right_rotate</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">Assuming x.left is not self.nil, symmetric to left_rotate</span>
        <span style="color: #FD971F;">y</span> = x.left

        <span style="color: #FD971F;">x.left</span> = y.right
        <span style="color: #F92672;">if</span> y.right != <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">y.right.parent</span> = x

        <span style="color: #FD971F;">y.parent</span> = x.parent
        <span style="color: #F92672;">if</span> x.parent == <span style="color: #F92672;">self</span>.nil:
            <span style="color: #F92672;">self</span>.root = y
        <span style="color: #F92672;">elif</span> x == x.parent.left:
            <span style="color: #FD971F;">x.parent.left</span> = y
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">x.parent.right</span> = y

        <span style="color: #FD971F;">y.right</span> = x
        <span style="color: #FD971F;">x.parent</span> = y

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, z<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">prev</span> = <span style="color: #F92672;">self</span>.nil
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.root
        <span style="color: #F92672;">while</span> curr != <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">prev</span> = curr
            <span style="color: #F92672;">if</span> curr.key &gt; z.key:
                <span style="color: #FD971F;">curr</span> = curr.left
            <span style="color: #F92672;">else</span>:
                <span style="color: #FD971F;">curr</span> = curr.right

        <span style="color: #F92672;">if</span> prev == <span style="color: #F92672;">self</span>.nil:
            <span style="color: #F92672;">self</span>.root = z
            <span style="color: #FD971F;">z.parent</span> = <span style="color: #F92672;">self</span>.nil
        <span style="color: #F92672;">elif</span> prev.key &gt; z.key:
            <span style="color: #FD971F;">prev.left</span> = z
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">prev.right</span> = z
        <span style="color: #FD971F;">z.parent</span> = prev
        <span style="color: #FD971F;">z.left</span> = <span style="color: #F92672;">self</span>.nil
        <span style="color: #FD971F;">z.right</span> = <span style="color: #F92672;">self</span>.nil
        <span style="color: #FD971F;">z.color</span> = Node.RED
        <span style="color: #F92672;">self</span>.insert_fixup<span style="color: #AE81FF;">(</span>z<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert_fixup</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, z<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">while</span> z.parent.color == Node.RED:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">z.parent.parent is guaranteed to exist, because the root is</span>
            <span style="color: #75715E;"># </span><span style="color: #75715E;">black. If a z.parent is red then it is not the root, so it must</span>
            <span style="color: #75715E;"># </span><span style="color: #75715E;">have parent.</span>
            <span style="color: #F92672;">if</span> z.parent == z.parent.parent.left:
                <span style="color: #FD971F;">y</span> = z.parent.parent.right  <span style="color: #75715E;"># </span><span style="color: #75715E;">uncle node</span>
                <span style="color: #F92672;">if</span> y.color == Node.RED:
                    <span style="color: #FD971F;">z.parent.color</span> = Node.BLACK
                    <span style="color: #FD971F;">y.color</span> = Node.BLACK
                    <span style="color: #FD971F;">z.parent.parent.color</span> = Node.RED
                    <span style="color: #FD971F;">z</span> = z.parent.parent
                <span style="color: #F92672;">else</span>:
                    <span style="color: #F92672;">if</span> z == z.parent.right:
                        <span style="color: #FD971F;">z</span> = z.parent
                        <span style="color: #F92672;">self</span>.left_rotate<span style="color: #AE81FF;">(</span>z<span style="color: #AE81FF;">)</span>
                    <span style="color: #FD971F;">z.parent.color</span> = Node.BLACK
                    <span style="color: #FD971F;">z.parent.parent.color</span> = Node.RED
                    <span style="color: #F92672;">self</span>.right_rotate<span style="color: #AE81FF;">(</span>z.parent.parent<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">else</span>:
                <span style="color: #FD971F;">y</span> = z.parent.parent.left
                <span style="color: #F92672;">if</span> y.color == Node.RED:
                    <span style="color: #FD971F;">z.parent.color</span> = Node.BLACK
                    <span style="color: #FD971F;">y.color</span> = Node.BLACK
                    <span style="color: #FD971F;">z.parent.parent.color</span> = Node.RED
                    <span style="color: #FD971F;">z</span> = z.parent.parent
                <span style="color: #F92672;">else</span>:
                    <span style="color: #F92672;">if</span> z == z.parent.left:
                        <span style="color: #FD971F;">z</span> = z.parent
                        <span style="color: #F92672;">self</span>.right_rotate<span style="color: #AE81FF;">(</span>z<span style="color: #AE81FF;">)</span>
                    <span style="color: #FD971F;">z.parent.color</span> = Node.BLACK
                    <span style="color: #FD971F;">z.parent.parent.color</span> = Node.RED
                    <span style="color: #F92672;">self</span>.left_rotate<span style="color: #AE81FF;">(</span>z.parent.parent<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.root.color = Node.BLACK

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">transplant</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, u, v<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> u.parent == <span style="color: #F92672;">self</span>.nil:
            <span style="color: #F92672;">self</span>.root = v
        <span style="color: #F92672;">elif</span> u == u.parent.left:
            <span style="color: #FD971F;">u.parent.left</span> = v
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">u.parent.right</span> = v
        <span style="color: #FD971F;">v.parent</span> = u.parent

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">minimum</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = x
        <span style="color: #F92672;">while</span> curr.left != <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">curr</span> = curr.left
        <span style="color: #F92672;">return</span> curr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">delete</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, z<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">y</span> = z  <span style="color: #75715E;"># </span><span style="color: #75715E;">y is either the node to be removed, or the node that replaces z</span>
        <span style="color: #FD971F;">y_original_color</span> = y.color
        <span style="color: #F92672;">if</span> z.left == <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">x</span> = z.right          <span style="color: #75715E;"># </span><span style="color: #75715E;">x moves into y's original position</span>
            <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>z, z.right<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">elif</span> z.right == <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">x</span> = z.left
            <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>z, z.left<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">y</span> = <span style="color: #F92672;">self</span>.minimum<span style="color: #AE81FF;">(</span>z.right<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">y_original_color</span> = y.color
            <span style="color: #FD971F;">x</span> = y.right
            <span style="color: #F92672;">if</span> y.parent == z:
                <span style="color: #FD971F;">x.parent</span> = y     <span style="color: #75715E;"># </span><span style="color: #cc9393;">TODO</span><span style="color: #75715E;">: why do we need this?????</span>
            <span style="color: #F92672;">else</span>:
                <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>y, y.right<span style="color: #AE81FF;">)</span>
                <span style="color: #FD971F;">y.right</span> = z.right
            <span style="color: #F92672;">self</span>.transplant<span style="color: #AE81FF;">(</span>z, y<span style="color: #AE81FF;">)</span>
            <span style="color: #FD971F;">y.left</span> = z.left
            <span style="color: #FD971F;">y.left.parent</span> = y
            <span style="color: #FD971F;">y.color</span> = z.color

        <span style="color: #F92672;">if</span> y_original_color == Node.BLACK:
            <span style="color: #F92672;">self</span>.delete_fixup<span style="color: #AE81FF;">(</span>x<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">delete_fixup</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">while</span> x != <span style="color: #F92672;">self</span>.root <span style="color: #F92672;">and</span> x.color == Node.BLACK:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">x must be a "doubly-black" node in this loop</span>
            <span style="color: #F92672;">if</span> x == x.parent.left:
                <span style="color: #FD971F;">w</span> = x.parent.right   <span style="color: #75715E;"># </span><span style="color: #75715E;">the sibling of x</span>
                <span style="color: #F92672;">if</span> w.color == Node.RED:
                    <span style="color: #75715E;"># </span><span style="color: #75715E;">convert to case 2 or 3 or 4 by rotation</span>
                    <span style="color: #FD971F;">w.color</span> = Node.BLACK         <span style="color: #75715E;"># </span><span style="color: #75715E;">case 1</span>
                    <span style="color: #FD971F;">x.parent.color</span> = Node.RED    <span style="color: #75715E;"># </span><span style="color: #75715E;">case 1</span>
                    <span style="color: #F92672;">self</span>.left_rotate<span style="color: #AE81FF;">(</span>x.parent<span style="color: #AE81FF;">)</span>   <span style="color: #75715E;"># </span><span style="color: #75715E;">case 1</span>
                    <span style="color: #FD971F;">w</span> = x.parent.right           <span style="color: #75715E;"># </span><span style="color: #75715E;">case 1</span>
                <span style="color: #F92672;">if</span> w.left.color == Node.BLACK <span style="color: #F92672;">and</span> w.right.color == Node.BLACK:
                    <span style="color: #FD971F;">w.color</span> = Node.RED           <span style="color: #75715E;"># </span><span style="color: #75715E;">case 2</span>
                    <span style="color: #FD971F;">x</span> = x.parent                 <span style="color: #75715E;"># </span><span style="color: #75715E;">case 2</span>
                <span style="color: #F92672;">else</span>:
                    <span style="color: #F92672;">if</span> w.right.color == Node.BLACK:
                        <span style="color: #FD971F;">w.color</span> = Node.RED         <span style="color: #75715E;"># </span><span style="color: #75715E;">case 3</span>
                        <span style="color: #FD971F;">w.left.color</span> = Node.BLACK  <span style="color: #75715E;"># </span><span style="color: #75715E;">case 3</span>
                        <span style="color: #F92672;">self</span>.right_rotate<span style="color: #AE81FF;">(</span>w<span style="color: #AE81FF;">)</span>       <span style="color: #75715E;"># </span><span style="color: #75715E;">case 3</span>
                        <span style="color: #FD971F;">w</span> = x.parent.right         <span style="color: #75715E;"># </span><span style="color: #75715E;">case 3</span>
                    <span style="color: #FD971F;">w.color</span> = x.parent.color       <span style="color: #75715E;"># </span><span style="color: #75715E;">case 4</span>
                    <span style="color: #FD971F;">x.parent.color</span> = Node.BLACK    <span style="color: #75715E;"># </span><span style="color: #75715E;">case 4</span>
                    <span style="color: #FD971F;">w.right.color</span> = Node.BLACK     <span style="color: #75715E;"># </span><span style="color: #75715E;">case 4</span>
                    <span style="color: #F92672;">self</span>.left_rotate<span style="color: #AE81FF;">(</span>x.parent<span style="color: #AE81FF;">)</span>     <span style="color: #75715E;"># </span><span style="color: #75715E;">case 4</span>
                    <span style="color: #FD971F;">x</span> = <span style="color: #F92672;">self</span>.root                  <span style="color: #75715E;"># </span><span style="color: #75715E;">case 4, terminate the loop</span>
            <span style="color: #F92672;">else</span>:
                <span style="color: #75715E;"># </span><span style="color: #75715E;">Symmetric to left node case</span>
                <span style="color: #FD971F;">w</span> = x.parent.left
                <span style="color: #F92672;">if</span> w.color == Node.RED:
                    <span style="color: #FD971F;">w.color</span> = Node.BLACK
                    <span style="color: #FD971F;">x.parent.color</span> = Node.RED
                    <span style="color: #F92672;">self</span>.right_rotate<span style="color: #AE81FF;">(</span>x.parent<span style="color: #AE81FF;">)</span>
                    <span style="color: #FD971F;">w</span> = x.parent.left
                <span style="color: #F92672;">if</span> w.left.color == Node.BLACK <span style="color: #F92672;">and</span> w.right.color == Node.BLACK:
                    <span style="color: #FD971F;">w.color</span> = Node.RED
                    <span style="color: #FD971F;">x</span> = x.parent
                <span style="color: #F92672;">else</span>:
                    <span style="color: #F92672;">if</span> w.left.color == Node.BLACK:
                        <span style="color: #FD971F;">w.color</span> = Node.RED
                        <span style="color: #FD971F;">w.right.color</span> = Node.BLACK
                        <span style="color: #F92672;">self</span>.left_rotate<span style="color: #AE81FF;">(</span>w<span style="color: #AE81FF;">)</span>
                    <span style="color: #FD971F;">w.color</span> = x.parent.color
                    <span style="color: #FD971F;">x.parent.color</span> = Node.BLACK
                    <span style="color: #FD971F;">w.left.color</span> = Node.BLACK
                    <span style="color: #F92672;">self</span>.right_rotate<span style="color: #AE81FF;">(</span>x.parent<span style="color: #AE81FF;">)</span>
                    <span style="color: #FD971F;">x</span> = <span style="color: #F92672;">self</span>.root

        <span style="color: #75715E;"># </span><span style="color: #75715E;">Outside the loop, x is either the root, or a "red-and-black" node</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">If x is the root, then root must be BLACK.</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">If x is a "red-and-black" node, then color it as black, because it</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">will have a RED child in case 2, and it might have RED parent.</span>
        <span style="color: #FD971F;">x.color</span> = Node.BLACK

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.root
        <span style="color: #F92672;">while</span> curr:
            <span style="color: #F92672;">if</span> curr.key == key:
                <span style="color: #F92672;">return</span> curr
            <span style="color: #F92672;">elif</span> curr.key &lt; key:
                <span style="color: #FD971F;">curr</span> = curr.right
            <span style="color: #F92672;">else</span>:
                <span style="color: #FD971F;">curr</span> = curr.left
        <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">pprint</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node, indent<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> node.parent == <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">"{}{} ({})"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span>indent, node.key, node.color<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">side</span> = <span style="color: #E6DB74;">"l"</span> <span style="color: #F92672;">if</span> node == node.parent.left <span style="color: #F92672;">else</span> <span style="color: #E6DB74;">"r"</span>
            <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">"{}{}: {} ({})"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span>indent, side, node.key, node.color<span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">if</span> node.left != <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">s</span> += <span style="color: #E6DB74;">"\n"</span> + <span style="color: #F92672;">self</span>.pprint<span style="color: #AE81FF;">(</span>node.left, <span style="color: #E6DB74;">"|---"</span> + indent<span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">if</span> node.right != <span style="color: #F92672;">self</span>.nil:
            <span style="color: #FD971F;">s</span> += <span style="color: #E6DB74;">"\n"</span> + <span style="color: #F92672;">self</span>.pprint<span style="color: #AE81FF;">(</span>node.right, <span style="color: #E6DB74;">"|---"</span> + indent<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> s

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>.pprint<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.root, <span style="color: #E6DB74;">""</span><span style="color: #AE81FF;">)</span> + <span style="color: #E6DB74;">"\n"</span>


<span style="color: #FD971F;">t</span> = RedBlackTree<span style="color: #AE81FF;">()</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">11</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">20</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">6</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span>-<span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span>Node<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">print(t.search(5))</span>
t.delete<span style="color: #AE81FF;">(</span>t.search<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
11 (BLACK)

11 (BLACK)
|---l: 3 (RED)

5 (BLACK)
|---l: 3 (RED)
|---r: 11 (RED)

5 (BLACK)
|---l: 3 (BLACK)
|---r: 11 (BLACK)
|---|---r: 20 (RED)

5 (BLACK)
|---l: 3 (BLACK)
|---r: 11 (BLACK)
|---|---l: 9 (RED)
|---|---r: 20 (RED)

5 (BLACK)
|---l: 3 (BLACK)
|---|---l: 1 (RED)
|---r: 11 (BLACK)
|---|---l: 9 (RED)
|---|---r: 20 (RED)

5 (BLACK)
|---l: 2 (BLACK)
|---|---l: 1 (RED)
|---|---r: 3 (RED)
|---r: 11 (BLACK)
|---|---l: 9 (RED)
|---|---r: 20 (RED)

5 (BLACK)
|---l: 2 (RED)
|---|---l: 1 (BLACK)
|---|---r: 3 (BLACK)
|---|---|---r: 4 (RED)
|---r: 11 (BLACK)
|---|---l: 9 (RED)
|---|---r: 20 (RED)

5 (BLACK)
|---l: 2 (RED)
|---|---l: 1 (BLACK)
|---|---r: 3 (BLACK)
|---|---|---r: 4 (RED)
|---r: 11 (RED)
|---|---l: 9 (BLACK)
|---|---|---l: 6 (RED)
|---|---r: 20 (BLACK)

5 (BLACK)
|---l: 2 (RED)
|---|---l: 1 (BLACK)
|---|---|---l: -1 (RED)
|---|---r: 3 (BLACK)
|---|---|---r: 4 (RED)
|---r: 11 (RED)
|---|---l: 9 (BLACK)
|---|---|---l: 6 (RED)
|---|---r: 20 (BLACK)

5 (BLACK)
|---l: 2 (RED)
|---|---l: 1 (BLACK)
|---|---|---l: -1 (RED)
|---|---r: 3 (BLACK)
|---|---|---l: 3 (RED)
|---|---|---r: 4 (RED)
|---r: 11 (RED)
|---|---l: 9 (BLACK)
|---|---|---l: 6 (RED)
|---|---r: 20 (BLACK)

6 (BLACK)
|---l: 2 (RED)
|---|---l: 1 (BLACK)
|---|---|---l: -1 (RED)
|---|---r: 3 (BLACK)
|---|---|---l: 3 (RED)
|---|---|---r: 4 (RED)
|---r: 11 (RED)
|---|---l: 9 (BLACK)
|---|---r: 20 (BLACK)

</pre></li>
</ul>
</div>
</div>
<div id="outline-container-orgaffc073" class="outline-3">
<h3 id="orgaffc073"><span class="section-number-3">2.19</span> Trie Tree</h3>
<div class="outline-text-3" id="text-2-19">
<ul class="org-ul">
<li><p>
Radix Tree
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.children = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">None</span><span style="color: #AE81FF;">]</span> * <span style="color: #AE81FF;">2</span>
        <span style="color: #F92672;">self</span>.isEnd = <span style="color: #AE81FF;">False</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">RadixTree</span>:
    <span style="color: #E6DB74;">"""</span>
<span style="color: #E6DB74;">    This radix tree only contains binary path at each node, i.e. it only stores</span>
<span style="color: #E6DB74;">    sting like "01100".</span>
<span style="color: #E6DB74;">    """</span>
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.root = Node<span style="color: #AE81FF;">()</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">getIdx</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, s<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">ord</span><span style="color: #AE81FF;">(</span>s<span style="color: #AE81FF;">)</span> - <span style="color: #F92672;">ord</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"0"</span><span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">getStr</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, idx<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">str</span><span style="color: #AE81FF;">(</span>idx<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">sort</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">sorted_arr</span> = <span style="color: #AE81FF;">[]</span>
        <span style="color: #FD971F;">stack</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.root, <span style="color: #E6DB74;">""</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">while</span> stack:
            <span style="color: #FD971F;">node</span>, <span style="color: #FD971F;">curr_str</span> = stack.pop<span style="color: #AE81FF;">()</span>
            <span style="color: #75715E;"># </span><span style="color: #d0bf8f;">NOTE</span><span style="color: #75715E;">: need to iterate the children from right to left, so left</span>
            <span style="color: #75715E;"># </span><span style="color: #75715E;">node will be traversed before right node</span>
            <span style="color: #F92672;">for</span> idx, n <span style="color: #F92672;">in</span> <span style="color: #F92672;">reversed</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">list</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">enumerate</span><span style="color: #A6E22E;">(</span>node.children<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>:
                <span style="color: #F92672;">if</span> n:
                    <span style="color: #FD971F;">next_str</span> = curr_str + <span style="color: #F92672;">self</span>.getStr<span style="color: #AE81FF;">(</span>idx<span style="color: #AE81FF;">)</span>
                    stack.append<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">(</span>n, next_str<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
                    <span style="color: #F92672;">if</span> n.isEnd:
                        sorted_arr.append<span style="color: #AE81FF;">(</span>next_str<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> sorted_arr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">sort_recursive</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._preorder_travel<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.root, <span style="color: #E6DB74;">""</span><span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">_preorder_travel</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node, s<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">sorted_arr</span> = <span style="color: #AE81FF;">[]</span>
        <span style="color: #F92672;">if</span> node.isEnd:
            sorted_arr.append<span style="color: #AE81FF;">(</span>s<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">for</span> idx, n <span style="color: #F92672;">in</span> <span style="color: #F92672;">enumerate</span><span style="color: #AE81FF;">(</span>node.children<span style="color: #AE81FF;">)</span>:
            <span style="color: #F92672;">if</span> n:
                sorted_arr.extend<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>._preorder_travel<span style="color: #66D9EF;">(</span>n, s + <span style="color: #F92672;">self</span>.getStr<span style="color: #A6E22E;">(</span>idx<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> sorted_arr

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, seq<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.root
        <span style="color: #F92672;">for</span> s <span style="color: #F92672;">in</span> seq:
            <span style="color: #FD971F;">idx</span> = <span style="color: #F92672;">self</span>.getIdx<span style="color: #AE81FF;">(</span>s<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> curr.children<span style="color: #AE81FF;">[</span>idx<span style="color: #AE81FF;">]</span>:
                <span style="color: #FD971F;">curr.children</span><span style="color: #AE81FF;">[</span>idx<span style="color: #AE81FF;">]</span> = Node<span style="color: #AE81FF;">()</span>
                <span style="color: #FD971F;">curr</span> = curr.children<span style="color: #AE81FF;">[</span>idx<span style="color: #AE81FF;">]</span>
                <span style="color: #FD971F;">curr.isEnd</span> = <span style="color: #AE81FF;">True</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">search</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, seq<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">curr</span> = <span style="color: #F92672;">self</span>.root
        <span style="color: #F92672;">for</span> s <span style="color: #F92672;">in</span> seq:
            <span style="color: #FD971F;">idx</span> = <span style="color: #F92672;">self</span>.getIdx<span style="color: #AE81FF;">(</span>s<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> curr.children<span style="color: #AE81FF;">[</span>idx<span style="color: #AE81FF;">]</span>:
                <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">False</span>
            <span style="color: #FD971F;">curr</span> = curr.children<span style="color: #AE81FF;">[</span>idx<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">return</span> curr.isEnd


<span style="color: #FD971F;">t</span> = RadixTree<span style="color: #AE81FF;">()</span>
t.insert<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"1011"</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"0"</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"100"</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"10"</span><span style="color: #AE81FF;">)</span>
t.insert<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"011"</span><span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.search<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"00"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.search<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"01"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.search<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"011"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.search<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"1011"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.sort<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>t.sort_recursive<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
False
False
False
True
['1', '0', '10', '101', '1011']
['0', '1', '10', '101', '1011']

</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org2043a32" class="outline-3">
<h3 id="org2043a32"><span class="section-number-3">2.20</span> (Binary) Heap</h3>
<div class="outline-text-3" id="text-2-20">
<ul class="org-ul">
<li>An array with two attributes: 1) length, the number of elements in the array. 2) heap<sub>size</sub>, the number of elements in the heap. The elements in the heap are from A[1] to A[A.heap<sub>size</sub>].</li>
<li>The heap has two properties:
<ul class="org-ul">
<li>Complete Binary Tree: the tree is completely filled in all levels except the lowest level. For the lowest level, the tree fills from left to right.</li>
<li>Heap property: all the parent values are larger (max-heap) / smaller (min-heap) or equal to the child values.</li>
</ul></li>
<li>Due to complete binary tree property, given a node index i, the parent index is floor(i/2), the left child index is 2*i, and the right child index is 2*i+1. NOTE: the root index is 1 (not 0).</li>
<li><p>
NOTE: heapify only takes O(n) time (it looks like O(nlogn), however, a tighter upper bound can be found, which is O(n)). <a href="https://www.geeksforgeeks.org/time-complexity-of-building-a-heap/">https://www.geeksforgeeks.org/time-complexity-of-building-a-heap/</a>
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> collections <span style="color: #F92672;">import</span> deque


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Heap</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.heap_size = <span style="color: #AE81FF;">0</span>
        <span style="color: #F92672;">self</span>._array = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__getitem__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, k<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">isinstance</span><span style="color: #AE81FF;">(</span>k, <span style="color: #F92672;">slice</span><span style="color: #AE81FF;">)</span>:
            <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">slice</span><span style="color: #66D9EF;">(</span>k.start + <span style="color: #AE81FF;">1</span>, k.stop + <span style="color: #AE81FF;">1</span>, k.step<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>k + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__len__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>.heap_size

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">parent</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, i<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> i // <span style="color: #AE81FF;">2</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">left</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, i<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">2</span> * i

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">right</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, i<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">2</span> * i + <span style="color: #AE81FF;">1</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">build_heap</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, A<span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">It can be proved that A[len(A) // 2], A[len(A) - 1] are leaf nodes.</span>
        <span style="color: #F92672;">self</span>.heap_size = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>._array = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> + A
        <span style="color: #75715E;"># </span><span style="color: #75715E;">The time complexity is upper bounded by O(nlogn), but actually the</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">tighter upper bound is O(n)</span>
        <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.heap_size // <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">0</span>, -<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">Build the heap bottom up</span>
            <span style="color: #F92672;">self</span>.max_heapify<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">max_heapify</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, i<span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">Assumes the binary trees rooted at self.left(i) and self.right(i) are</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">max-heap</span>

        <span style="color: #75715E;"># </span><span style="color: #75715E;">The Time complexity of this operation is O(log n), or O(h), where h</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">is the height of the tree</span>
        <span style="color: #FD971F;">lft</span> = <span style="color: #F92672;">self</span>.left<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">rht</span> = <span style="color: #F92672;">self</span>.right<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">if</span> lft &lt;= <span style="color: #F92672;">self</span>.heap_size <span style="color: #F92672;">and</span> <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> &lt; <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>lft<span style="color: #AE81FF;">]</span>:
            <span style="color: #FD971F;">largest</span> = lft
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">largest</span> = i

        <span style="color: #F92672;">if</span> rht &lt;= <span style="color: #F92672;">self</span>.heap_size <span style="color: #F92672;">and</span> <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>largest<span style="color: #AE81FF;">]</span> &lt; <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>rht<span style="color: #AE81FF;">]</span>:
            <span style="color: #FD971F;">largest</span> = rht

        <span style="color: #F92672;">if</span> largest != i:
            <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>largest<span style="color: #AE81FF;">]</span> = <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>
                largest<span style="color: #AE81FF;">]</span>, <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
            <span style="color: #F92672;">self</span>.max_heapify<span style="color: #AE81FF;">(</span>largest<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">maximum</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">extract_max</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">Time complexity O(logn)</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.heap_size &lt; <span style="color: #AE81FF;">1</span>:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Heap underflow!"</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">max</span> = <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.heap_size<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">self</span>.heap_size -= <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">self</span>.max_heapify<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">max</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">insert</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">Time complexity O(logn)</span>
        <span style="color: #F92672;">self</span>.heap_size += <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">self</span>._array.append<span style="color: #AE81FF;">(</span>-<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.increase_key<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.heap_size, x<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">increase_key</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, i, k<span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">Time complexity O(logn)</span>
        <span style="color: #F92672;">if</span> k &lt; <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">Exception</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"New key must be larger than the current key."</span><span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> = k
        <span style="color: #F92672;">while</span> i &gt; <span style="color: #AE81FF;">1</span> <span style="color: #F92672;">and</span> <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> &gt; <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.parent<span style="color: #66D9EF;">(</span>i<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.parent<span style="color: #66D9EF;">(</span>i<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>, <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> = <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #F92672;">self</span>._array<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.parent<span style="color: #66D9EF;">(</span>i<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
            <span style="color: #FD971F;">i</span> = <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__str__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">str</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span>:<span style="color: #F92672;">len</span><span style="color: #A6E22E;">(</span><span style="color: #F92672;">self</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">heap_sort</span><span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Time complexity O(nlogn)</span>
    <span style="color: #FD971F;">h</span> = Heap<span style="color: #AE81FF;">()</span>
    h.build_heap<span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">q</span> = deque<span style="color: #AE81FF;">()</span>
    <span style="color: #F92672;">while</span> h.heap_size &gt; <span style="color: #AE81FF;">0</span>:
        q.appendleft<span style="color: #AE81FF;">(</span>h.extract_max<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> <span style="color: #F92672;">list</span><span style="color: #AE81FF;">(</span>q<span style="color: #AE81FF;">)</span>


<span style="color: #75715E;"># </span><span style="color: #75715E;">A = [1, 2, 3, 4, 5, 6]</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">h = Heap(A, 100)</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">print(h)</span>

<span style="color: #FD971F;">A</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">100</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">90</span>, <span style="color: #AE81FF;">45</span>, <span style="color: #AE81FF;">1000</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">h</span> = Heap<span style="color: #AE81FF;">()</span>
h.build_heap<span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>h<span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">sorted_A</span> = heap_sort<span style="color: #AE81FF;">(</span>A<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>sorted_A<span style="color: #AE81FF;">)</span>

<span style="color: #FD971F;">h</span> = Heap<span style="color: #AE81FF;">()</span>
h.insert<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">7</span><span style="color: #AE81FF;">)</span>
h.insert<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">100</span><span style="color: #AE81FF;">)</span>
h.insert<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
h.insert<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">6</span><span style="color: #AE81FF;">)</span>
h.insert<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">90</span><span style="color: #AE81FF;">)</span>
h.insert<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">45</span><span style="color: #AE81FF;">)</span>
h.insert<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">32</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>h.maximum<span style="color: #66D9EF;">()</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>h<span style="color: #AE81FF;">)</span>
h.increase_key<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">1000</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>h<span style="color: #AE81FF;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org6b59825" class="outline-3">
<h3 id="org6b59825"><span class="section-number-3">2.21</span> Dynamic Programming</h3>
<div class="outline-text-3" id="text-2-21">
<ul class="org-ul">
<li>Divide-and-conquer algorithms partition the problem into disjoint subproblems, solve the subproblems recursively, and then combine their solutions to solve the original problem.</li>
<li>Dynamic programming applies when the subproblems overlap, that is when subproblems share subsubproblems. In this context, divide-and-conquer does more work than necessary, repeatedly solve the common subsubproblems.</li>
<li>Dynamic programming solve each subsubproblem just once and saves its answer in a table to avoid solving the same problem again.</li>
<li>To develop a dynamic programming algorithm, we follow 4 steps:
<ul class="org-ul">
<li>Characterize the structure of an optimal solution</li>
<li>Recursively define the value of an optimal solution</li>
<li>Compute the value of an optimal solution, typically in a bottom-up fashion</li>
<li>Construct an optimal solution from computed information</li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgd9bfb76" class="outline-4">
<h4 id="orgd9bfb76"><span class="section-number-4">2.21.1</span> Rod cutting</h4>
<div class="outline-text-4" id="text-2-21-1">
<ul class="org-ul">
<li><p>
Top-down method utilizing memoization
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">cut_rod</span><span style="color: #AE81FF;">(</span>price, n<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">memo</span> = <span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">return</span> helper_cut_rod<span style="color: #AE81FF;">(</span>price, n, memo<span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">helper_cut_rod</span><span style="color: #AE81FF;">(</span>price, n, memo<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> memo<span style="color: #AE81FF;">[</span>n - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> != -<span style="color: #AE81FF;">1</span>:
        <span style="color: #F92672;">return</span> memo<span style="color: #AE81FF;">[</span>n - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">if</span> n == <span style="color: #AE81FF;">0</span>:
        <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">0</span>
    <span style="color: #FD971F;">optimal_price</span> = -<span style="color: #AE81FF;">1</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, n + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">optimal_price</span> = <span style="color: #F92672;">max</span><span style="color: #AE81FF;">(</span>optimal_price, price<span style="color: #66D9EF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">]</span> + helper_cut_rod<span style="color: #66D9EF;">(</span>price, n - i, memo<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">memo</span><span style="color: #AE81FF;">[</span>n - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = optimal_price
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>memo<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> optimal_price


<span style="color: #FD971F;">price</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">8</span>, <span style="color: #AE81FF;">9</span>, <span style="color: #AE81FF;">10</span>, <span style="color: #AE81FF;">17</span>, <span style="color: #AE81FF;">17</span>, <span style="color: #AE81FF;">20</span>, <span style="color: #AE81FF;">24</span>, <span style="color: #AE81FF;">30</span><span style="color: #AE81FF;">]</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cut_rod<span style="color: #66D9EF;">(</span>price, <span style="color: #AE81FF;">10</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
[1, 2, -1, -1, -1, -1, -1, -1, -1, -1]
[1, 5, -1, -1, -1, -1, -1, -1, -1, -1]
[1, 5, 6, -1, -1, -1, -1, -1, -1, -1]
[1, 5, 6, -1, -1, -1, -1, -1, -1, -1]
[1, 5, 8, -1, -1, -1, -1, -1, -1, -1]
[1, 5, 8, 9, -1, -1, -1, -1, -1, -1]
[1, 5, 8, 10, -1, -1, -1, -1, -1, -1]
[1, 5, 8, 10, -1, -1, -1, -1, -1, -1]
[1, 5, 8, 10, -1, -1, -1, -1, -1, -1]
[1, 5, 8, 10, 11, -1, -1, -1, -1, -1]
[1, 5, 8, 10, 13, -1, -1, -1, -1, -1]
[1, 5, 8, 10, 13, -1, -1, -1, -1, -1]
[1, 5, 8, 10, 13, -1, -1, -1, -1, -1]
[1, 5, 8, 10, 13, -1, -1, -1, -1, -1]
[1, 5, 8, 10, 13, 14, -1, -1, -1, -1]
[1, 5, 8, 10, 13, 15, -1, -1, -1, -1]
[1, 5, 8, 10, 13, 16, -1, -1, -1, -1]
[1, 5, 8, 10, 13, 16, -1, -1, -1, -1]
[1, 5, 8, 10, 13, 16, -1, -1, -1, -1]
[1, 5, 8, 10, 13, 17, -1, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, -1, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 19, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, -1, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 23, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 23, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, -1]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 26]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 27]
[1, 5, 8, 10, 13, 17, 18, 22, 25, 57]
57
</pre>

<ul class="org-ul">
<li><p>
Bottom-up method
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">cut_rod</span><span style="color: #AE81FF;">(</span>price, n<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">optimal_price</span>, <span style="color: #FD971F;">cut_points</span> = cut_rod_helper<span style="color: #AE81FF;">(</span>price, n<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">optimal_cut_points</span> = <span style="color: #AE81FF;">[]</span>
    <span style="color: #FD971F;">curr_len</span> = n
    <span style="color: #F92672;">while</span> curr_len &gt; <span style="color: #AE81FF;">0</span>:
        optimal_cut_points.append<span style="color: #AE81FF;">(</span>cut_points<span style="color: #66D9EF;">[</span>curr_len<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">curr_len</span> = curr_len - cut_points<span style="color: #AE81FF;">[</span>curr_len<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">return</span> optimal_price<span style="color: #AE81FF;">[</span>n<span style="color: #AE81FF;">]</span>, optimal_cut_points


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">cut_rod_helper</span><span style="color: #AE81FF;">(</span>price, n<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">memo</span> = <span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n + <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">cut_point</span> = <span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n + <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">memo</span><span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #FD971F;">cut_point</span><span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, n + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">opt</span> = -<span style="color: #AE81FF;">1</span>
        <span style="color: #FD971F;">cp</span> = -<span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, i + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
            <span style="color: #FD971F;">tmp</span> = price<span style="color: #AE81FF;">[</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> + memo<span style="color: #AE81FF;">[</span>i - j<span style="color: #AE81FF;">]</span>
            <span style="color: #F92672;">if</span> tmp &gt; opt:
                <span style="color: #FD971F;">opt</span> = tmp
                <span style="color: #FD971F;">cp</span> = j
                <span style="color: #FD971F;">memo</span><span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> = opt
                <span style="color: #FD971F;">cut_point</span><span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> = cp
                <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>memo<span style="color: #AE81FF;">)</span>
                <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cut_point<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> memo, cut_point


<span style="color: #FD971F;">price</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">8</span>, <span style="color: #AE81FF;">9</span>, <span style="color: #AE81FF;">10</span>, <span style="color: #AE81FF;">17</span>, <span style="color: #AE81FF;">17</span>, <span style="color: #AE81FF;">20</span>, <span style="color: #AE81FF;">24</span>, <span style="color: #AE81FF;">30</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">opt_price</span>, <span style="color: #FD971F;">opt_cut</span> = cut_rod<span style="color: #AE81FF;">(</span>price, <span style="color: #AE81FF;">7</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>opt_price<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>opt_cut<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[0, 1, -1, -1, -1, -1, -1, -1]
[0, 1, -1, -1, -1, -1, -1, -1]
[0, 1, 2, -1, -1, -1, -1, -1]
[0, 1, 1, -1, -1, -1, -1, -1]
[0, 1, 5, -1, -1, -1, -1, -1]
[0, 1, 2, -1, -1, -1, -1, -1]
[0, 1, 5, 6, -1, -1, -1, -1]
[0, 1, 2, 1, -1, -1, -1, -1]
[0, 1, 5, 8, -1, -1, -1, -1]
[0, 1, 2, 3, -1, -1, -1, -1]
[0, 1, 5, 8, 9, -1, -1, -1]
[0, 1, 2, 3, 1, -1, -1, -1]
[0, 1, 5, 8, 10, -1, -1, -1]
[0, 1, 2, 3, 2, -1, -1, -1]
[0, 1, 5, 8, 10, 11, -1, -1]
[0, 1, 2, 3, 2, 1, -1, -1]
[0, 1, 5, 8, 10, 13, -1, -1]
[0, 1, 2, 3, 2, 2, -1, -1]
[0, 1, 5, 8, 10, 13, 14, -1]
[0, 1, 2, 3, 2, 2, 1, -1]
[0, 1, 5, 8, 10, 13, 15, -1]
[0, 1, 2, 3, 2, 2, 2, -1]
[0, 1, 5, 8, 10, 13, 16, -1]
[0, 1, 2, 3, 2, 2, 3, -1]
[0, 1, 5, 8, 10, 13, 17, -1]
[0, 1, 2, 3, 2, 2, 6, -1]
[0, 1, 5, 8, 10, 13, 17, 18]
[0, 1, 2, 3, 2, 2, 6, 1]
18
[1, 6]
</pre>

<ul class="org-ul">
<li>Subproblem Graph</li>
</ul>

<div class="figure">
<p><img src="subproblem_graph.png" alt="subproblem_graph.png" />
</p>
</div>

<ul class="org-ul">
<li>Top-down approach performs a "Depth-First-Search" of the subproblem graph.</li>
<li>Bottom-up approach solves the subproblem in a "reverse topological sort" order.</li>
<li>The time complexity of the dynamic ptrogramming is O(V + E), where V are the nodes, E are the edges of the graph.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org3603f4e" class="outline-4">
<h4 id="org3603f4e"><span class="section-number-4">2.21.2</span> Matrix-chain multiplication</h4>
<div class="outline-text-4" id="text-2-21-2">
<ul class="org-ul">
<li><p>
2D DP problem
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">matrix_chain_order</span><span style="color: #AE81FF;">(</span>p<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">n</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>p<span style="color: #AE81FF;">)</span> - <span style="color: #AE81FF;">1</span>
    <span style="color: #FD971F;">m</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #A6E22E;">(</span>n<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">s</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #A6E22E;">(</span>n<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>n<span style="color: #AE81FF;">)</span>:
        m<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>i<span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">0</span>
        s<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>i<span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">0</span>

    <span style="color: #F92672;">for</span> d <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, n<span style="color: #AE81FF;">)</span>:
        <span style="color: #75715E;"># </span><span style="color: #75715E;">l is the difference between start and end indices</span>
        <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>n - d<span style="color: #AE81FF;">)</span>:
            <span style="color: #FD971F;">j</span> = i + d
            <span style="color: #75715E;"># </span><span style="color: #75715E;">i is the start index</span>
            <span style="color: #F92672;">for</span> k <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>i, j<span style="color: #AE81FF;">)</span>:
                <span style="color: #75715E;"># </span><span style="color: #75715E;">k is the relative split position</span>
                <span style="color: #FD971F;">tmp</span> = m<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>k<span style="color: #AE81FF;">]</span> + m<span style="color: #AE81FF;">[</span>k + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> + p<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> * p<span style="color: #AE81FF;">[</span>k + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> * p<span style="color: #AE81FF;">[</span>j + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
                <span style="color: #F92672;">if</span> m<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> == -<span style="color: #AE81FF;">1</span>:
                    m<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = tmp
                    s<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = k
                <span style="color: #F92672;">elif</span> m<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> &gt; tmp:
                    m<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = tmp
                    s<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = k
    <span style="color: #F92672;">return</span> m, s


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">print_solution</span><span style="color: #AE81FF;">(</span>s, i, j<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">sol</span> = <span style="color: #E6DB74;">""</span>
    <span style="color: #F92672;">if</span> i == j:
        <span style="color: #FD971F;">sol</span> += <span style="color: #E6DB74;">"A_{}"</span>.<span style="color: #F92672;">format</span><span style="color: #AE81FF;">(</span>i + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">else</span>:
        <span style="color: #FD971F;">sol</span> += <span style="color: #E6DB74;">"("</span>
        <span style="color: #FD971F;">sol</span> += print_solution<span style="color: #AE81FF;">(</span>s, i, s<span style="color: #66D9EF;">[</span>i<span style="color: #66D9EF;">][</span>j<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">sol</span> += print_solution<span style="color: #AE81FF;">(</span>s, s<span style="color: #66D9EF;">[</span>i<span style="color: #66D9EF;">][</span>j<span style="color: #66D9EF;">]</span> + <span style="color: #AE81FF;">1</span>, j<span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">sol</span> += <span style="color: #E6DB74;">")"</span>
    <span style="color: #F92672;">return</span> sol



<span style="color: #FD971F;">p</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">30</span>, <span style="color: #AE81FF;">35</span>, <span style="color: #AE81FF;">15</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">10</span>, <span style="color: #AE81FF;">20</span>, <span style="color: #AE81FF;">25</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">m</span>, <span style="color: #FD971F;">s</span> = matrix_chain_order<span style="color: #AE81FF;">(</span>p<span style="color: #AE81FF;">)</span>
<span style="color: #FD971F;">sol</span> = print_solution<span style="color: #AE81FF;">(</span>s, <span style="color: #AE81FF;">0</span>, <span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>m<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>m<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>s<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>sol<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[[0, 15750, 7875, 9375, 11875, 15125], [-1, 0, 2625, 4375, 7125, 10500], [-1, -1, 0, 750, 2500, 5375], [-1, -1, -1, 0, 1000, 3500], [-1, -1, -1, -1, 0, 5000], [-1, -1, -1, -1, -1, 0]]
[[0, 0, 0, 2, 2, 2], [-1, 0, 1, 2, 2, 2], [-1, -1, 0, 2, 2, 2], [-1, -1, -1, 0, 3, 4], [-1, -1, -1, -1, 0, 4], [-1, -1, -1, -1, -1, 0]]
((A_1(A_2A_3))((A_4A_5)A_6))

</pre>

<ul class="org-ul">
<li>Elements of dynamic programming
<ul class="org-ul">
<li>Optimal substructure
<ul class="org-ul">
<li>We build an optimal solution to the problem from optimal solutions of the subproblems.</li>
<li>Common pattern in discovering optimal substructure:
<ul class="org-ul">
<li>A solution to the problem consists of making a choice. Making to the choice leads to solving one or more subproblems.</li>
<li>You suppose for a given problem, you are given the choice that leads to an optimal solution. You do not concern yourself yet with how the choice came up. You just assume it has been given to you.</li>
<li>Given the choice, you determine which subproblems follow, and how to best characterize the resulting space of subproblems (e.g. memo[i], memo[i][j]).</li>
<li>You show that the solutions to the subproblems used within an optimal solution to the problem must be optimal themselves to the subproblems. You can prove it by contradiction.</li>
</ul></li>
<li>Optimal substructure varies across problem domains in two ways:
<ul class="org-ul">
<li>how many subproblems an optimal solution to the original problem uses</li>
<li>how many choices we have in determining which subproblems to use in an optimal solution.</li>
</ul></li>
<li>Informally, the running time of a dynamic-programming algorithm depends on the product of two factors:
<ul class="org-ul">
<li>the number of subproblems overall, denoted as n (i.e. the vertices of the subproblem graph).</li>
<li>how many choices we look at for each subproblem, denoted as m (i.e. the edges of each vertex, so the total edge number will be n * m).</li>
</ul></li>
<li>DP versus greedy:
<ul class="org-ul">
<li>DP solves the subproblem first, and then use the solutions of the subproblems to solve the original problem</li>
<li>Greedy first make a "greedy" choice (the choice that looks best at the time), and then solve a resulting subproblem. It doesn't bothering to solve every possible smaller subproblems first. In some cases, this strategy works.</li>
</ul></li>
<li>Independence between subproblems
<ul class="org-ul">
<li>If solving subproblems will need to share information between subproblems in order to find the optimal solution to the original problem, then the problem cannot be solved using DP. Example: unweighted longest simple path in a directed graph.</li>
</ul></li>
</ul></li>
<li>Overlapping subproblems
<ul class="org-ul">
<li>When a recursive algorithm revisits the same problem repeatedly, then the optimization problem has overlapping subproblems.</li>
</ul></li>
</ul></li>

<li><p>
Longest Common Subsequence
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">longest_common_subsequence</span><span style="color: #AE81FF;">(</span>x, y<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">m</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>x<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">n</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>y<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">c</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span> <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #A6E22E;">(</span>n + <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>m + <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">d</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #A6E22E;">(</span>n<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>m<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, m + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, n + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
            <span style="color: #F92672;">if</span> x<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> == y<span style="color: #AE81FF;">[</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>:
                c<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = c<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> + <span style="color: #AE81FF;">1</span>
                d<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">2</span>  <span style="color: #75715E;"># </span><span style="color: #75715E;">2 means go to left up corner for parent</span>
            <span style="color: #F92672;">elif</span> c<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> &gt; c<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>:
                c<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = c<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span>
                d<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">0</span>  <span style="color: #75715E;"># </span><span style="color: #75715E;">0 means go left for parent</span>
            <span style="color: #F92672;">else</span>:
                c<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = c<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
                d<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">1</span>  <span style="color: #75715E;"># </span><span style="color: #75715E;">1 means go right for parent</span>
    <span style="color: #F92672;">return</span> c<span style="color: #AE81FF;">[</span>m<span style="color: #AE81FF;">][</span>n<span style="color: #AE81FF;">]</span>, d


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">print_lcs</span><span style="color: #AE81FF;">(</span>x, d, i, j<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> i &lt; <span style="color: #AE81FF;">0</span> <span style="color: #F92672;">or</span> j &lt; <span style="color: #AE81FF;">0</span>:
        <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">""</span>

    <span style="color: #FD971F;">s</span> = <span style="color: #E6DB74;">""</span>
    <span style="color: #F92672;">if</span> d<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> == <span style="color: #AE81FF;">2</span>:
        <span style="color: #FD971F;">s</span> += print_lcs<span style="color: #AE81FF;">(</span>x, d, i - <span style="color: #AE81FF;">1</span>, j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">s</span> += x<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">elif</span> d<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> == <span style="color: #AE81FF;">0</span>:
        <span style="color: #FD971F;">s</span> += print_lcs<span style="color: #AE81FF;">(</span>x, d, i - <span style="color: #AE81FF;">1</span>, j<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">else</span>:
        <span style="color: #FD971F;">s</span> += print_lcs<span style="color: #AE81FF;">(</span>x, d, i, j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> s


<span style="color: #FD971F;">x</span> = <span style="color: #E6DB74;">"abcbdab"</span>
<span style="color: #FD971F;">y</span> = <span style="color: #E6DB74;">"bdcaba"</span>

<span style="color: #FD971F;">ct</span>, <span style="color: #FD971F;">d</span> = longest_common_subsequence<span style="color: #AE81FF;">(</span>x, y<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>ct<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>print_lcs<span style="color: #66D9EF;">(</span>x, d, <span style="color: #F92672;">len</span><span style="color: #A6E22E;">(</span>x<span style="color: #A6E22E;">)</span> - <span style="color: #AE81FF;">1</span>, <span style="color: #F92672;">len</span><span style="color: #A6E22E;">(</span>y<span style="color: #A6E22E;">)</span> - <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
4
bdab

</pre>

<p>
NOTE: if only the length is needed, then there is no need to keep the whole lookup table. Only the latest two rows of the table is needed.
</p></li>

<li><p>
Optimal Binary Search Tree
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">optimal_bst</span><span style="color: #AE81FF;">(</span>p, q, n<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">e</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span> <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #A6E22E;">(</span>n + <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n + <span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>  <span style="color: #75715E;"># </span><span style="color: #75715E;">e[1 to n + 1][0 to n]</span>
    <span style="color: #FD971F;">w</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span> <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #A6E22E;">(</span>n + <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n + <span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">root</span> = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #A6E22E;">(</span>n + <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n + <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, n + <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>:
        e<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = q<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
        w<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> = q<span style="color: #AE81FF;">[</span>i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">for</span> d <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>n<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">1</span>, n - d + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
            <span style="color: #FD971F;">j</span> = i + d
            e<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = <span style="color: #F92672;">float</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"inf"</span><span style="color: #AE81FF;">)</span>
            w<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = w<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> + p<span style="color: #AE81FF;">[</span>j - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> + q<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span>
            <span style="color: #F92672;">for</span> k <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>i, j + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
                <span style="color: #FD971F;">tmp</span> = e<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>k - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> + e<span style="color: #AE81FF;">[</span>k + <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> + w<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span>
                <span style="color: #F92672;">if</span> tmp &lt; e<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span>:
                    e<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = tmp
                    root<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span> = k
                    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>e<span style="color: #AE81FF;">)</span>
                    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>w<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> e<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span>n<span style="color: #AE81FF;">]</span>, root


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">print_sol</span><span style="color: #AE81FF;">(</span>root, i, j<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> i &gt; j:
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'d{}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>j<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span>
    <span style="color: #FD971F;">k</span> = root<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span>j<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"k{}"</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>k<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Left:"</span><span style="color: #AE81FF;">)</span>
    print_sol<span style="color: #AE81FF;">(</span>root, i, k - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"Right:"</span><span style="color: #AE81FF;">)</span>
    print_sol<span style="color: #AE81FF;">(</span>root, k + <span style="color: #AE81FF;">1</span>, j<span style="color: #AE81FF;">)</span>


<span style="color: #FD971F;">p</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">15</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">05</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">q</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">05</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">05</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">05</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">05</span>, <span style="color: #AE81FF;">0</span>.<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>
<span style="color: #FD971F;">n</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>p<span style="color: #AE81FF;">)</span>
<span style="color: #FD971F;">e_opt</span>, <span style="color: #FD971F;">root</span> = optimal_bst<span style="color: #AE81FF;">(</span>p, q, n<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>e_opt<span style="color: #AE81FF;">)</span>
print_sol<span style="color: #AE81FF;">(</span>root, <span style="color: #AE81FF;">1</span>, n<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[[0, 0, 0, 0, 0, 0], [0.05, 0.45000000000000007, 0.9, 1.25, 1.75, 2.75], [0, 0.1, 0.4, 0.7, 1.2, 2.0], [0, 0, 0.05, 0.25, 0.6, 1.2999999999999998], [0, 0, 0, 0.05, 0.30000000000000004, 0.9], [0, 0, 0, 0, 0.05, 0.5], [0, 0, 0, 0, 0, 0.1]]
[[0, 0, 0, 0, 0, 0], [0.05, 0.30000000000000004, 0.45, 0.55, 0.7000000000000001, 1.0000000000000002], [0, 0.1, 0.25, 0.35, 0.49999999999999994, 0.7999999999999999], [0, 0, 0.05, 0.15000000000000002, 0.3, 0.6], [0, 0, 0, 0.05, 0.2, 0.5], [0, 0, 0, 0, 0.05, 0.35], [0, 0, 0, 0, 0, 0.1]]
2.75
k2
Left:
k1
Left:
d0
Right:
d1
Right:
k5
Left:
k4
Left:
k3
Left:
d2
Right:
d3
Right:
d4
Right:
d5
</pre></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org8a10c7d" class="outline-4">
<h4 id="org8a10c7d"><span class="section-number-4">2.21.3</span> 0/1 Knapsack</h4>
</div>
<div id="outline-container-org9b7eb22" class="outline-4">
<h4 id="org9b7eb22"><span class="section-number-4">2.21.4</span> Edit Distance</h4>
</div>
</div>

<div id="outline-container-org3d66b55" class="outline-3">
<h3 id="org3d66b55"><span class="section-number-3">2.22</span> Greedy Algorithms</h3>
<div class="outline-text-3" id="text-2-22">
</div>
<div id="outline-container-orgcf51138" class="outline-4">
<h4 id="orgcf51138"><span class="section-number-4">2.22.1</span> Interval-graph coloring problem</h4>
<div class="outline-text-4" id="text-2-22-1">
<p>
Meeting rooms II: <a href="https://leetcode.com/problems/meeting-rooms-ii/">https://leetcode.com/problems/meeting-rooms-ii/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org8972728" class="outline-3">
<h3 id="org8972728"><span class="section-number-3">2.23</span> Union Find</h3>
<div class="outline-text-3" id="text-2-23">
<p>
Union find with rank and path compression.
The time complexity of union find with both rank and path compression is O(m
&alpha;(n)), where m is the number of make-set, find, union operations, n is
the number of make-set operations (only happens at the beginning, usually
means n nodes). &alpha;(n) is a very slowly growing function, &alpha;(n) &lt; 4 in
most of the practical cases. Hence, the time complexity is almost linear to
the number of operations. Each operation nearly takes constant time.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">UnionFind</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, size<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.parent = <span style="color: #F92672;">list</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>size<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.rank = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>size<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">find</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">while</span> x != <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">[</span>x<span style="color: #AE81FF;">]</span>:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">path compression, connect the grandchild node with its grandparent every time executing find</span>
            <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">[</span>x<span style="color: #AE81FF;">]</span> = <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">[</span><span style="color: #F92672;">self</span>.parent<span style="color: #66D9EF;">[</span>x<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">]</span>
            <span style="color: #FD971F;">x</span> = <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">[</span>x<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">return</span> x

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">union</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, x, y<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Before Union'</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Parent: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.parent<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Rank: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.rank<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">xroot</span> = <span style="color: #F92672;">self</span>.find<span style="color: #AE81FF;">(</span>x<span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">yroot</span> = <span style="color: #F92672;">self</span>.find<span style="color: #AE81FF;">(</span>y<span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.rank<span style="color: #AE81FF;">[</span>xroot<span style="color: #AE81FF;">]</span> &gt; <span style="color: #F92672;">self</span>.rank<span style="color: #AE81FF;">[</span>yroot<span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">[</span>y<span style="color: #AE81FF;">]</span> = xroot
        <span style="color: #F92672;">elif</span> <span style="color: #F92672;">self</span>.rank<span style="color: #AE81FF;">[</span>x<span style="color: #AE81FF;">]</span> &lt; <span style="color: #F92672;">self</span>.rank<span style="color: #AE81FF;">[</span>y<span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">[</span>x<span style="color: #AE81FF;">]</span> = yroot
        <span style="color: #F92672;">else</span>:
            <span style="color: #75715E;"># </span><span style="color: #75715E;">rank only increases when the two sets to join have the same rank</span>
            <span style="color: #F92672;">self</span>.parent<span style="color: #AE81FF;">[</span>y<span style="color: #AE81FF;">]</span> = xroot
            <span style="color: #F92672;">self</span>.rank<span style="color: #AE81FF;">[</span>xroot<span style="color: #AE81FF;">]</span> += <span style="color: #AE81FF;">1</span>

        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'After Union'</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Parent: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.parent<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Rank: {}'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span><span style="color: #F92672;">self</span>.rank<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>


<span style="color: #FD971F;">uf</span> = UnionFind<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">10</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">9</span>, <span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">8</span>, <span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>uf.find<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>uf.find<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>uf.find<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">9</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">6</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">9</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">8</span><span style="color: #AE81FF;">)</span>
uf.union<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">6</span>, <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Before Union
Parent: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
After Union
Parent: [0, 1, 2, 3, 3, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 0, 0]
Before Union
Parent: [0, 1, 2, 3, 3, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 0, 0]
After Union
Parent: [0, 1, 2, 3, 9, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 0, 1]
Before Union
Parent: [0, 1, 2, 3, 9, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 0, 1]
After Union
Parent: [8, 1, 2, 3, 9, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 1, 1]
Before Union
Parent: [8, 1, 2, 3, 9, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 1, 1]
After Union
Parent: [8, 1, 3, 3, 9, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 1, 1]
3
3
9
Before Union
Parent: [8, 1, 3, 3, 9, 5, 6, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 0, 0, 0, 1, 1]
After Union
Parent: [8, 1, 3, 3, 9, 5, 5, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 1, 0, 0, 1, 1]
Before Union
Parent: [8, 1, 3, 3, 9, 5, 5, 7, 8, 9]
Rank: [0, 0, 0, 1, 0, 1, 0, 0, 1, 1]
After Union
Parent: [8, 1, 3, 3, 9, 5, 5, 7, 8, 5]
Rank: [0, 0, 0, 1, 0, 2, 0, 0, 1, 1]
Before Union
Parent: [8, 1, 3, 3, 9, 5, 5, 7, 8, 5]
Rank: [0, 0, 0, 1, 0, 2, 0, 0, 1, 1]
After Union
Parent: [8, 1, 3, 3, 9, 5, 5, 3, 8, 5]
Rank: [0, 0, 0, 1, 0, 2, 0, 0, 1, 1]
Before Union
Parent: [8, 1, 3, 3, 9, 5, 5, 3, 8, 5]
Rank: [0, 0, 0, 1, 0, 2, 0, 0, 1, 1]
After Union
Parent: [8, 1, 3, 3, 5, 5, 5, 3, 5, 5]
Rank: [0, 0, 0, 1, 0, 2, 0, 0, 1, 1]
Before Union
Parent: [8, 1, 3, 3, 5, 5, 5, 3, 5, 5]
Rank: [0, 0, 0, 1, 0, 2, 0, 0, 1, 1]
After Union
Parent: [8, 5, 3, 3, 5, 5, 5, 3, 5, 5]
Rank: [0, 0, 0, 1, 0, 2, 0, 0, 1, 1]
</pre>
</div>
</div>
<div id="outline-container-org3885f95" class="outline-3">
<h3 id="org3885f95"><span class="section-number-3">2.24</span> Single-source shortest path</h3>
<div class="outline-text-3" id="text-2-24">
</div>
<div id="outline-container-org341f51d" class="outline-4">
<h4 id="org341f51d"><span class="section-number-4">2.24.1</span> Bellman-Ford</h4>
</div>
</div>
<div id="outline-container-org5f6b7ab" class="outline-3">
<h3 id="org5f6b7ab"><span class="section-number-3">2.25</span> Quick Select</h3>
<div class="outline-text-3" id="text-2-25">
<p>
Time complexity: worst case O(n<sup>2</sup>) if the pivot is always the biggest or smallest.
best case O(n), if we can always decrease the array to search by half, then 1 + 1/2 + 1/4 + &#x2026; = 2.
average O(n).
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">quickSelect</span><span style="color: #AE81FF;">(</span>nums, k<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">left</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #FD971F;">right</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>nums<span style="color: #AE81FF;">)</span> - <span style="color: #AE81FF;">1</span>
    <span style="color: #F92672;">while</span> left &lt; right:
        <span style="color: #FD971F;">pivot_idx</span> = partition<span style="color: #AE81FF;">(</span>nums, left, right<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">if</span> pivot_idx == k - <span style="color: #AE81FF;">1</span>:
            <span style="color: #F92672;">break</span>
        <span style="color: #F92672;">elif</span> pivot_idx &lt; k - <span style="color: #AE81FF;">1</span>:
            <span style="color: #FD971F;">left</span> = pivot_idx + <span style="color: #AE81FF;">1</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">right</span> = pivot_idx - <span style="color: #AE81FF;">1</span>
    <span style="color: #F92672;">return</span> nums<span style="color: #AE81FF;">[</span>:k<span style="color: #AE81FF;">]</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">partition</span><span style="color: #AE81FF;">(</span>nums, left, right<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">pivot</span> = nums<span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">i</span> = left
    <span style="color: #F92672;">for</span> j <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>left, right<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> nums<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> &lt; pivot:
            nums<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">nums</span><span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> = nums<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span>, nums<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
            <span style="color: #FD971F;">i</span> += <span style="color: #AE81FF;">1</span>

    nums<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">nums</span><span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span> = nums<span style="color: #AE81FF;">[</span>right<span style="color: #AE81FF;">]</span>, nums<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">return</span> i


<span style="color: #FD971F;">nums</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">9</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">7</span>, <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">]</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>quickSelect<span style="color: #66D9EF;">(</span>nums, <span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6e9b21c" class="outline-3">
<h3 id="org6e9b21c"><span class="section-number-3">2.26</span> Graph Coloring Problem</h3>
<div class="outline-text-3" id="text-2-26">
<p>
The general graph coloring problem (find the minimum number of colors that
the adjacent nodes do not share the same color) is NP-Complete. Greedy
algorithm can only find an upper bound of the color numbers, but it is not
guaranteed to be the optimal.
</p>
</div>
</div>
<div id="outline-container-org0261ae1" class="outline-3">
<h3 id="org0261ae1"><span class="section-number-3">2.27</span> Tree in the context of graph</h3>
<div class="outline-text-3" id="text-2-27">
<ul class="org-ul">
<li>A tree is an undirected graph in which any two vertices are connected by exactly one path. Any connected graph without simple cycles is a tree.</li>
<li>Any connected graph who has n nodes with n - 1 edges is a tree.</li>
<li>Diameter of a graph: longest of the shortest paths of any two pairs in a graph.</li>
<li>Remoteness: the length of the longest path from the node to its leaves.</li>
<li>Center: the node that has the smallest remoteness. Or if treating the node as the root of the tree, the tree has the minimal height.</li>
<li>Theorem: There can be at most two centers for a tree.</li>
<li>Theorem: the center of the tree must be on the diameter of the tree.</li>
</ul>
</div>
</div>
<div id="outline-container-org9460108" class="outline-3">
<h3 id="org9460108"><span class="section-number-3">2.28</span> Bellman-Ford Algorithm</h3>
<div class="outline-text-3" id="text-2-28">
<ul class="org-ul">
<li>Repeat |V| - 1 times, for each edge, relax the edge</li>
<li>The reason for |V| - 1 times: because any simple path from u to v has at most |V| - 1 edges. Otherwise, the path has cycle. Positive cycles will not contribute to shortest path.</li>
<li>After |V| - times, if we do the relaxation for all the edges one more time, we can detect negative cycles if certain nodes got relaxed again.</li>
</ul>
</div>
</div>
<div id="outline-container-orgad94372" class="outline-3">
<h3 id="orgad94372"><span class="section-number-3">2.29</span> Dijkstra's Algorithm</h3>
<div class="outline-text-3" id="text-2-29">
<ul class="org-ul">
<li>Works for directed and undirected graphs.</li>
<li>Greedy, always find the node with the shortest distance so far and relax its edges.</li>
<li><p>
Does not work with negative weights.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> heapq <span style="color: #F92672;">import</span> heappush, heappop
<span style="color: #F92672;">from</span> collections <span style="color: #F92672;">import</span> deque


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">dijkstra</span><span style="color: #AE81FF;">(</span>n, edges, start<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">graph</span> = buildGraph<span style="color: #AE81FF;">(</span>n, edges<span style="color: #AE81FF;">)</span>

    <span style="color: #FD971F;">dist</span> = <span style="color: #AE81FF;">[</span><span style="color: #F92672;">float</span><span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">'inf'</span><span style="color: #66D9EF;">)</span> <span style="color: #F92672;">for</span> _ <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">dist</span><span style="color: #AE81FF;">[</span>start<span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">0</span>

    <span style="color: #FD971F;">parent</span> = <span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span> <span style="color: #F92672;">for</span> _ <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">parent</span><span style="color: #AE81FF;">[</span>start<span style="color: #AE81FF;">]</span> = start

    <span style="color: #FD971F;">minHeap</span> = <span style="color: #AE81FF;">[]</span>
    heappush<span style="color: #AE81FF;">(</span>minHeap, <span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">0</span>, start<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

    <span style="color: #FD971F;">visited</span> = <span style="color: #F92672;">set</span><span style="color: #AE81FF;">()</span>
    <span style="color: #F92672;">while</span> minHeap:
        <span style="color: #FD971F;">d</span>, <span style="color: #FD971F;">node</span> = heappop<span style="color: #AE81FF;">(</span>minHeap<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">if</span> node <span style="color: #F92672;">in</span> visited:
            <span style="color: #F92672;">continue</span>

        <span style="color: #FD971F;">dist</span><span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span> = d
        visited.add<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">for</span> nei, w <span style="color: #F92672;">in</span> graph<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span>:
            <span style="color: #F92672;">if</span> nei <span style="color: #F92672;">not</span> <span style="color: #F92672;">in</span> visited:
                <span style="color: #F92672;">if</span> dist<span style="color: #AE81FF;">[</span>nei<span style="color: #AE81FF;">]</span> &gt; dist<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span> + w:
                    <span style="color: #FD971F;">dist</span><span style="color: #AE81FF;">[</span>nei<span style="color: #AE81FF;">]</span> = dist<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span> + w
                    <span style="color: #FD971F;">parent</span><span style="color: #AE81FF;">[</span>nei<span style="color: #AE81FF;">]</span> = node
                    heappush<span style="color: #AE81FF;">(</span>minHeap, <span style="color: #66D9EF;">(</span>dist<span style="color: #A6E22E;">[</span>nei<span style="color: #A6E22E;">]</span>, nei<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'Shortest distance from {}:'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>start<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>dist<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'All the shortest paths starting from {}:'</span>.<span style="color: #F92672;">format</span><span style="color: #66D9EF;">(</span>start<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span>n<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">"-&gt;"</span>.join<span style="color: #66D9EF;">(</span><span style="color: #F92672;">map</span><span style="color: #A6E22E;">(</span><span style="color: #F92672;">str</span>, reconstruct_path<span style="color: #E6DB74;">(</span>parent, i<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">reconstruct_path</span><span style="color: #AE81FF;">(</span>parent, node<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">path</span> = deque<span style="color: #AE81FF;">()</span>
    <span style="color: #F92672;">while</span> node != parent<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span>:
        path.appendleft<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">node</span> = parent<span style="color: #AE81FF;">[</span>node<span style="color: #AE81FF;">]</span>
        path.appendleft<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> path


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">buildGraph</span><span style="color: #AE81FF;">(</span>n, edges<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">graph</span> = <span style="color: #AE81FF;">{</span>i: <span style="color: #F92672;">set</span><span style="color: #66D9EF;">()</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">}</span>
    <span style="color: #F92672;">for</span> u, v, w <span style="color: #F92672;">in</span> edges:
        graph<span style="color: #AE81FF;">[</span>u<span style="color: #AE81FF;">]</span>.add<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">(</span>v, w<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> graph


dijkstra<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">5</span>, <span style="color: #66D9EF;">[</span><span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">10</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">3</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">2</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">5</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">2</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">]</span><span style="color: #66D9EF;">]</span>, <span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
Shortest distance from 0:
[0, 5, 3, 6, 2]
All the shortest paths starting from 0:

0-&gt;2-&gt;2-&gt;1
0-&gt;2
0-&gt;2-&gt;2-&gt;1-&gt;1-&gt;3
0-&gt;4

</pre></li>
</ul>
</div>
</div>
<div id="outline-container-org9abbc0f" class="outline-3">
<h3 id="org9abbc0f"><span class="section-number-3">2.30</span> Sliding window technique</h3>
<div class="outline-text-3" id="text-2-30">
<p>
<a href="https://leetcode.com/problems/minimum-window-substring/">https://leetcode.com/problems/minimum-window-substring/</a>
</p>
</div>
</div>
<div id="outline-container-org7174c04" class="outline-3">
<h3 id="org7174c04"><span class="section-number-3">2.31</span> Greatest Common Divisor</h3>
<div class="outline-text-3" id="text-2-31">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">gcd</span><span style="color: #AE81FF;">(</span>a, b<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> a &lt; b:
        <span style="color: #FD971F;">a</span>, <span style="color: #FD971F;">b</span> = b, a

    <span style="color: #75715E;"># </span><span style="color: #75715E;">now a is always larger than b</span>
    <span style="color: #F92672;">while</span> b != <span style="color: #AE81FF;">0</span>:
        <span style="color: #FD971F;">tmp</span> = b
        <span style="color: #FD971F;">b</span> = a % b
        <span style="color: #FD971F;">a</span> = tmp

    <span style="color: #F92672;">return</span> a


<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>gcd<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">100</span>, <span style="color: #AE81FF;">30</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>gcd<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">100</span>, <span style="color: #AE81FF;">11</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
10
1

</pre>
</div>
</div>
<div id="outline-container-orgc7c56e3" class="outline-3">
<h3 id="orgc7c56e3"><span class="section-number-3">2.32</span> Find prime numbers less than n</h3>
<div class="outline-text-3" id="text-2-32">
</div>
<div id="outline-container-org1285ce7" class="outline-4">
<h4 id="org1285ce7"><span class="section-number-4">2.32.1</span> Method 1 - brute force</h4>
<div class="outline-text-4" id="text-2-32-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">printPrime</span><span style="color: #AE81FF;">(</span>n<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">res</span> = <span style="color: #AE81FF;">[]</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">2</span>, n<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> isPrime<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>:
            res.append<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> res

<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">isPrime</span><span style="color: #AE81FF;">(</span>x<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">2</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> x % i == <span style="color: #AE81FF;">0</span>:
            <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">False</span>
    <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">True</span>


<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>printPrime<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">20</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[2, 3, 5, 7, 11, 13, 17, 19]

</pre>
</div>
</div>
<div id="outline-container-org5f19eb4" class="outline-4">
<h4 id="org5f19eb4"><span class="section-number-4">2.32.2</span> Method 2 - better brute force</h4>
<div class="outline-text-4" id="text-2-32-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">printPrime</span><span style="color: #AE81FF;">(</span>n<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">res</span> = <span style="color: #AE81FF;">[]</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">2</span>, n<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> isPrime<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>:
            res.append<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> res


<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">isPrime</span><span style="color: #AE81FF;">(</span>x<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">2</span>, x<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> i * i &gt; x:
            <span style="color: #F92672;">break</span>
        <span style="color: #F92672;">if</span> x % i == <span style="color: #AE81FF;">0</span>:
            <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">False</span>
    <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">True</span>


<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>printPrime<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">20</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[2, 3, 5, 7, 11, 13, 17, 19]

</pre>
</div>
</div>
<div id="outline-container-org137106a" class="outline-4">
<h4 id="org137106a"><span class="section-number-4">2.32.3</span> Method 3 - Sieve of Eratothenes</h4>
<div class="outline-text-4" id="text-2-32-3">
<p>
Key idea: mark multiples as not a prime.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">printPrime</span><span style="color: #AE81FF;">(</span>n<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">if</span> n &lt;= <span style="color: #AE81FF;">2</span>:
        <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">[]</span>

    <span style="color: #FD971F;">res</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">]</span>

    <span style="color: #FD971F;">isPrime</span> = <span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">True</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span>n<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">4</span>, n<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> i % <span style="color: #AE81FF;">2</span> == <span style="color: #AE81FF;">0</span>:
            <span style="color: #FD971F;">isPrime</span><span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">False</span>

    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span>, n, <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> isPrime<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>:
            <span style="color: #FD971F;">x</span> = i * i
            <span style="color: #F92672;">while</span> x &lt; n:
                <span style="color: #FD971F;">isPrime</span><span style="color: #AE81FF;">[</span>x<span style="color: #AE81FF;">]</span> = <span style="color: #AE81FF;">False</span>
                <span style="color: #FD971F;">x</span> += i

    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span>, n<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> isPrime<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>:
            res.append<span style="color: #AE81FF;">(</span>i<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> res


<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>printPrime<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">100</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>printPrime<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>printPrime<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>printPrime<span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">10</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97]
[]
[2]
[2, 3, 5, 7]

</pre>
</div>
</div>
</div>

<div id="outline-container-org0cc0e0b" class="outline-3">
<h3 id="org0cc0e0b"><span class="section-number-3">2.33</span> Bit Manipulation</h3>
<div class="outline-text-3" id="text-2-33">
</div>
<div id="outline-container-orgeac8ced" class="outline-4">
<h4 id="orgeac8ced"><span class="section-number-4">2.33.1</span> XOR</h4>
<div class="outline-text-4" id="text-2-33-1">
<ul class="org-ul">
<li>Commutative law: a ^ b = b ^ a</li>
<li>Associative law: (a ^ b) ^ c = a ^ (b ^ c)</li>
<li>a ^ b ^ b = a</li>
<li>a ^ 0 = a</li>
<li>a ^ a = 0</li>
<li>Flip the n-th bit: mask = 1 &lt;&lt; i, flipped<sub>x</sub> = x ^ mask</li>
<li>Swap two values without using extra space</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #FD971F;">a</span> = a ^ b
<span style="color: #FD971F;">b</span> = a ^ b
<span style="color: #FD971F;">a</span> = a ^ b
</pre>
</div>
</div>
</div>
<div id="outline-container-org52583ae" class="outline-4">
<h4 id="org52583ae"><span class="section-number-4">2.33.2</span> int</h4>
<div class="outline-text-4" id="text-2-33-2">
<p>
a int type (signed int) is 32 bit (4 bytes), representing integers from [-2**31, 2**31 - 1].
</p>
</div>
</div>
</div>
<div id="outline-container-orga937968" class="outline-3">
<h3 id="orga937968"><span class="section-number-3">2.34</span> Knuth Shuffling (Fisher-Yates shuffle)</h3>
<div class="outline-text-3" id="text-2-34">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">import</span> random

<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">knuthShuffle</span><span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">len</span><span style="color: #66D9EF;">(</span>arr<span style="color: #66D9EF;">)</span> - <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span>, -<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">j</span> = random.randint<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">0</span>, i<span style="color: #AE81FF;">)</span>
        arr<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>, <span style="color: #FD971F;">arr</span><span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span> = arr<span style="color: #AE81FF;">[</span>j<span style="color: #AE81FF;">]</span>, arr<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">]</span>

<span style="color: #FD971F;">arr</span> = <span style="color: #F92672;">list</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">10</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
knuthShuffle<span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>arr<span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[1, 8, 9, 2, 7, 0, 3, 5, 4, 6]

</pre>
</div>
</div>
<div id="outline-container-org8024772" class="outline-3">
<h3 id="org8024772"><span class="section-number-3">2.35</span> Reservoir Sampling</h3>
<div class="outline-text-3" id="text-2-35">
<p>
Sample k numbers from n numbers. Consider the number array is very large that it cannot fit in memory.
</p>
<ul class="org-ul">
<li>Can we sample the the number in a streaming fashion?</li>
<li>The answer is reservoir sampling!
<ul class="org-ul">
<li>If current selected number is less than k, then keep appending the new number into the selected number array.</li>
<li>If current selected number is equal to k, when the i th number arrives, keep the new number with probablity of k / i and discard one of the old numbers equally randomly (otherwise, just keep the old ones).</li>
<li><p>
In the end, each number is kept in the selected set with probablity of k / n.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">import</span> random

<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">reservoirSampling</span><span style="color: #AE81FF;">(</span>nums, k<span style="color: #AE81FF;">)</span>:
    <span style="color: #E6DB74;">"""</span>
<span style="color: #E6DB74;">    Randomly draw k samples from a very large array nums.</span>

<span style="color: #E6DB74;">    Assuming nums is a very large array that cannot fit in memory, we can only</span>
<span style="color: #E6DB74;">    sample nums in a streaming fashion.</span>
<span style="color: #E6DB74;">    """</span>
    <span style="color: #FD971F;">reservoir</span> = <span style="color: #AE81FF;">[]</span>
    <span style="color: #F92672;">for</span> i, x <span style="color: #F92672;">in</span> <span style="color: #F92672;">enumerate</span><span style="color: #AE81FF;">(</span>nums<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span>reservoir<span style="color: #AE81FF;">)</span> &lt; k:
            reservoir.append<span style="color: #AE81FF;">(</span>x<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">else</span>:
            <span style="color: #FD971F;">rn</span> = random.randint<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">0</span>, i - <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">if</span> rn &lt; k:
                <span style="color: #FD971F;">reservoir</span><span style="color: #AE81FF;">[</span>rn<span style="color: #AE81FF;">]</span> = x
    <span style="color: #F92672;">return</span> reservoir


<span style="color: #FD971F;">nums</span> = <span style="color: #F92672;">list</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">10001</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>reservoirSampling<span style="color: #66D9EF;">(</span>nums, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #FD971F;">nums</span> = <span style="color: #F92672;">list</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">7</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>reservoirSampling<span style="color: #66D9EF;">(</span>nums, <span style="color: #AE81FF;">5</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[5974, 4744, 4354, 2221, 6505]
[1, 2, 6, 4, 5]

</pre></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgfc77204" class="outline-3">
<h3 id="orgfc77204"><span class="section-number-3">2.36</span> Random pick number with weight</h3>
<div class="outline-text-3" id="text-2-36">
<ul class="org-ul">
<li>Compute the accumulated sum.</li>
<li>Generate a random number in range of [0, accum<sub>sum</sub>[-1]).</li>
<li>Perform a binary search to see the random number sits in which interval (defined by the accumulated sum array).</li>
</ul>
</div>
</div>
<div id="outline-container-org00b51c7" class="outline-3">
<h3 id="org00b51c7"><span class="section-number-3">2.37</span> Monotonic Queue/Stack</h3>
<div class="outline-text-3" id="text-2-37">
<p>
<a href="https://leetcode.com/problems/shortest-subarray-with-sum-at-least-k/discuss/204290/Monotonic-Queue-Summary">https://leetcode.com/problems/shortest-subarray-with-sum-at-least-k/discuss/204290/Monotonic-Queue-Summary</a>
<a href="https://leetcode.com/problems/daily-temperatures/">https://leetcode.com/problems/daily-temperatures/</a>
<a href="https://leetcode.com/problems/sliding-window-maximum/">https://leetcode.com/problems/sliding-window-maximum/</a>
</p>

<p>
A queue where the elements from front to end are always strictly increasing
(or nondecreasing) or decreasing (or nonincreasing).
</p>

<p>
When a new value arrives, it kicks the values that are smaller than it in
front of it for an increasing queue.
</p>

<p>
It enables finding the maximum in a queue in O(1) time.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">import</span> collections


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">MaxQueue</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">object</span><span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.queue = collections.deque<span style="color: #AE81FF;">()</span>
        <span style="color: #F92672;">self</span>.max_q = collections.deque<span style="color: #AE81FF;">()</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">append</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, val<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.queue.append<span style="color: #AE81FF;">(</span>val<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">while</span> <span style="color: #F92672;">self</span>.max_q <span style="color: #F92672;">and</span> <span style="color: #F92672;">self</span>.max_q<span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> &lt; val:
            <span style="color: #F92672;">self</span>.max_q.pop<span style="color: #AE81FF;">()</span>
            <span style="color: #F92672;">self</span>.max_q.append<span style="color: #AE81FF;">(</span>val<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">popleft</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">val</span> = <span style="color: #F92672;">self</span>.queue.popleft<span style="color: #AE81FF;">()</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.max_q <span style="color: #F92672;">and</span> <span style="color: #F92672;">self</span>.max_q<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> == val:
            <span style="color: #F92672;">self</span>.max_q.popleft<span style="color: #AE81FF;">()</span>
        <span style="color: #F92672;">return</span> val

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">getMax</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>.max_q<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.max_q <span style="color: #F92672;">else</span> <span style="color: #AE81FF;">None</span>
</pre>
</div>

<ul class="org-ul">
<li>Monotonic (increasing) stack can be used to find the <b><b>Previous Less Element</b></b> and <b><b>Next Less Element</b></b> in O(n) time.</li>
<li>This is very helpful for the histogram problem <a href="https://leetcode.com/problems/largest-rectangle-in-histogram/">https://leetcode.com/problems/largest-rectangle-in-histogram/</a></li>
<li>Similar problems:
<ul class="org-ul">
<li><a href="https://leetcode.com/problems/sum-of-subarray-minimums/">https://leetcode.com/problems/sum-of-subarray-minimums/</a></li>
<li><a href="https://leetcode.com/problems/shortest-subarray-with-sum-at-least-k/">https://leetcode.com/problems/shortest-subarray-with-sum-at-least-k/</a></li>
<li><a href="https://leetcode.com/problems/online-stock-span/">https://leetcode.com/problems/online-stock-span/</a></li>
<li><a href="https://leetcode.com/problems/daily-temperatures/">https://leetcode.com/problems/daily-temperatures/</a></li>
<li></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org79120e7" class="outline-3">
<h3 id="org79120e7"><span class="section-number-3">2.38</span> Producer Consumer Pattern</h3>
</div>
<div id="outline-container-org7145315" class="outline-3">
<h3 id="org7145315"><span class="section-number-3">2.39</span> Dutch national flag problem (three-way-partition problem)</h3>
<div class="outline-text-3" id="text-2-39">
<p>
Like quick sort partition, but has one more pointer to partition the array into three chunks.
</p>
<ul class="org-ul">
<li>This algorithm can be used to improve quick sort: partition the array into &lt; pivot, = pivot and &gt; pivot 3 parts. This can be useful if there is lots of duplicates in the array.</li>
</ul>
</div>
</div>
<div id="outline-container-org9c23e25" class="outline-3">
<h3 id="org9c23e25"><span class="section-number-3">2.40</span> Hamiltonian path and hamiltonian cycle</h3>
<div class="outline-text-3" id="text-2-40">
<ul class="org-ul">
<li>A Hamiltonian path is a path that visits each vertex of the graph exactly once.</li>
<li>A Hamiltonian cycle is a cycle that visits each vertext exactly once.</li>
</ul>

<p>
Backtrack
</p>
</div>
</div>
<div id="outline-container-orgbf74893" class="outline-3">
<h3 id="orgbf74893"><span class="section-number-3">2.41</span> Least Recently Used (LRU) cache</h3>
<div class="outline-text-3" id="text-2-41">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">LRUCache</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">object</span><span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, capacity<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.capacity = capacity
        <span style="color: #F92672;">self</span>.key_map = <span style="color: #AE81FF;">{}</span>
        <span style="color: #F92672;">self</span>.dlist = DoublyLinkedList<span style="color: #AE81FF;">()</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">put</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key, value<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> key <span style="color: #F92672;">not</span> <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.key_map <span style="color: #F92672;">and</span> <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.key_map<span style="color: #AE81FF;">)</span> == <span style="color: #F92672;">self</span>.capacity:
            <span style="color: #FD971F;">tail</span> = <span style="color: #F92672;">self</span>.dlist.pop<span style="color: #AE81FF;">()</span>
            <span style="color: #F92672;">self</span>.key_map.pop<span style="color: #AE81FF;">(</span>tail.key<span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">if</span> key <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.key_map:
            <span style="color: #F92672;">self</span>.dlist.remove<span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.key_map<span style="color: #66D9EF;">[</span>key<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">node</span> = Node<span style="color: #AE81FF;">(</span>key, value<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.key_map<span style="color: #AE81FF;">[</span>key<span style="color: #AE81FF;">]</span> = node
        <span style="color: #F92672;">self</span>.dlist.appendleft<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">get</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">if</span> key <span style="color: #F92672;">not</span> <span style="color: #F92672;">in</span> <span style="color: #F92672;">self</span>.key_map:
            <span style="color: #F92672;">return</span> <span style="color: #AE81FF;">None</span>
        <span style="color: #FD971F;">node</span> = <span style="color: #F92672;">self</span>.key_map<span style="color: #AE81FF;">[</span>key<span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">self</span>.dlist.remove<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.dlist.appendleft<span style="color: #AE81FF;">(</span>node<span style="color: #AE81FF;">)</span>
        <span style="color: #75715E;"># </span><span style="color: #75715E;">print(node)</span>
        <span style="color: #F92672;">return</span> node.val


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">DoublyLinkedList</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">object</span><span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.sentinel = Node<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.sentinel.<span style="color: #F92672;">next</span> = <span style="color: #F92672;">self</span>.sentinel
        <span style="color: #F92672;">self</span>.sentinel.prev = <span style="color: #F92672;">self</span>.sentinel

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">appendleft</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">head</span> = <span style="color: #F92672;">self</span>.sentinel.<span style="color: #F92672;">next</span>
        <span style="color: #F92672;">self</span>.sentinel.<span style="color: #F92672;">next</span> = node
        <span style="color: #FD971F;">node.prev</span> = <span style="color: #F92672;">self</span>.sentinel
        <span style="color: #FD971F;">head.prev</span> = node
        node.<span style="color: #F92672;">next</span> = head

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">pop</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">tail</span> = <span style="color: #F92672;">self</span>.getTail<span style="color: #AE81FF;">()</span>
        <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> tail:
            <span style="color: #F92672;">raise</span> <span style="color: #66D9EF;">IndexError</span><span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'The list is empty!'</span><span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">self</span>.remove<span style="color: #AE81FF;">(</span>tail<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> tail

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">remove</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, node<span style="color: #AE81FF;">)</span>:
        node.prev.<span style="color: #F92672;">next</span> = node.<span style="color: #F92672;">next</span>
        node.<span style="color: #F92672;">next</span>.prev = node.prev

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">getHead</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>.sentinel.<span style="color: #F92672;">next</span> <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.sentinel.<span style="color: #F92672;">next</span> <span style="color: #F92672;">is</span> <span style="color: #F92672;">not</span> <span style="color: #F92672;">self</span>.sentinel <span style="color: #F92672;">else</span> <span style="color: #AE81FF;">None</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">getTail</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span><span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">return</span> <span style="color: #F92672;">self</span>.sentinel.prev <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.sentinel.prev <span style="color: #F92672;">is</span> <span style="color: #F92672;">not</span> <span style="color: #F92672;">self</span>.sentinel <span style="color: #F92672;">else</span> <span style="color: #AE81FF;">None</span>


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">Node</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">object</span><span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, key, val<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">self</span>.key = key
        <span style="color: #F92672;">self</span>.val = val
        <span style="color: #F92672;">self</span>.<span style="color: #F92672;">next</span> = <span style="color: #AE81FF;">None</span>
        <span style="color: #F92672;">self</span>.prev = <span style="color: #AE81FF;">None</span>


<span style="color: #FD971F;">cache</span> = LRUCache<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'a'</span>, <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'b'</span>, <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'c'</span>, <span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'c'</span>, <span style="color: #AE81FF;">4</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'c'</span>, <span style="color: #AE81FF;">5</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'d'</span>, <span style="color: #AE81FF;">6</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cache.get<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">'a'</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cache.get<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">'b'</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cache.get<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">'c'</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'e'</span>, <span style="color: #AE81FF;">7</span><span style="color: #AE81FF;">)</span>
cache.put<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">'e'</span>, <span style="color: #AE81FF;">8</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>cache.get<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">'b'</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
None
2
5
2

</pre>
</div>
</div>
<div id="outline-container-orgd91a584" class="outline-3">
<h3 id="orgd91a584"><span class="section-number-3">2.42</span> Interval problems</h3>
<div class="outline-text-3" id="text-2-42">
</div>
<div id="outline-container-org0a36c48" class="outline-4">
<h4 id="org0a36c48"><span class="section-number-4">2.42.1</span> Count number of events happening concurrently at certain time point</h4>
<div class="outline-text-4" id="text-2-42-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">from</span> heapq <span style="color: #F92672;">import</span> heappush, heappop


<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">EventCounter</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">object</span><span style="color: #AE81FF;">)</span>:
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">__init__</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, intervals<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">pq</span> = <span style="color: #AE81FF;">[]</span>
        <span style="color: #F92672;">for</span> start, end <span style="color: #F92672;">in</span> intervals:
            heappush<span style="color: #AE81FF;">(</span>pq, <span style="color: #66D9EF;">(</span>start, <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
            heappush<span style="color: #AE81FF;">(</span>pq, <span style="color: #66D9EF;">(</span>end, -<span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

        <span style="color: #F92672;">self</span>.count = <span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span>-<span style="color: #F92672;">float</span><span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">'inf'</span><span style="color: #A6E22E;">)</span>, <span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">]</span>
        <span style="color: #F92672;">while</span> pq:
            <span style="color: #FD971F;">time</span>, <span style="color: #FD971F;">diff</span> = heappop<span style="color: #AE81FF;">(</span>pq<span style="color: #AE81FF;">)</span>
            <span style="color: #F92672;">if</span> time == <span style="color: #F92672;">self</span>.count<span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span>:
                <span style="color: #F92672;">self</span>.count<span style="color: #AE81FF;">[</span>-<span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span> += diff
            <span style="color: #F92672;">else</span>:
                <span style="color: #F92672;">self</span>.count.append<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span>time, <span style="color: #F92672;">self</span>.count<span style="color: #A6E22E;">[</span>-<span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">][</span><span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">]</span> + diff<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>

    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">query</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>, time<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.count<span style="color: #AE81FF;">)</span>
        <span style="color: #FD971F;">left</span> = <span style="color: #AE81FF;">0</span>
        <span style="color: #FD971F;">right</span> = <span style="color: #F92672;">len</span><span style="color: #AE81FF;">(</span><span style="color: #F92672;">self</span>.count<span style="color: #AE81FF;">)</span> - <span style="color: #AE81FF;">1</span>
        <span style="color: #FD971F;">res</span> = <span style="color: #AE81FF;">0</span>
        <span style="color: #F92672;">while</span> left &lt;= right:
            <span style="color: #FD971F;">mid</span> = left + <span style="color: #AE81FF;">(</span>right - left<span style="color: #AE81FF;">)</span> // <span style="color: #AE81FF;">2</span>
            <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.count<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> &lt;= time:
                <span style="color: #FD971F;">res</span> = <span style="color: #F92672;">self</span>.count<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>

            <span style="color: #F92672;">if</span> <span style="color: #F92672;">self</span>.count<span style="color: #AE81FF;">[</span>mid<span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">0</span><span style="color: #AE81FF;">]</span> &lt;= time:
                <span style="color: #FD971F;">left</span> = mid + <span style="color: #AE81FF;">1</span>
            <span style="color: #F92672;">else</span>:
                <span style="color: #FD971F;">right</span> = mid - <span style="color: #AE81FF;">1</span>
                <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>res<span style="color: #AE81FF;">)</span>
        <span style="color: #F92672;">return</span> res


<span style="color: #FD971F;">ec</span> = EventCounter<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">[</span><span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">5</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">3</span>, <span style="color: #AE81FF;">8</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">8</span><span style="color: #A6E22E;">]</span>, <span style="color: #A6E22E;">[</span><span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">10</span><span style="color: #A6E22E;">]</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">)</span>
ec.query<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span><span style="color: #AE81FF;">)</span>
ec.query<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">5</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
[[-inf, 0], [2, 1], [3, 2], [4, 3], [5, 3], [8, 1], [10, 0]]
0
[[-inf, 0], [2, 1], [3, 2], [4, 3], [5, 3], [8, 1], [10, 0]]
3

</pre>
</div>
</div>

<div id="outline-container-org341f2f9" class="outline-4">
<h4 id="org341f2f9"><span class="section-number-4">2.42.2</span> Meeting room problem</h4>
</div>
<div id="outline-container-org35f25be" class="outline-4">
<h4 id="org35f25be"><span class="section-number-4">2.42.3</span> Merge intervals</h4>
</div>
<div id="outline-container-orgdfa5842" class="outline-4">
<h4 id="orgdfa5842"><span class="section-number-4">2.42.4</span> add/delete intervals</h4>
</div>
</div>
<div id="outline-container-orgc7ee628" class="outline-3">
<h3 id="orgc7ee628"><span class="section-number-3">2.43</span> API Limiter</h3>
</div>
<div id="outline-container-org9789a13" class="outline-3">
<h3 id="org9789a13"><span class="section-number-3">2.44</span> Minimax</h3>
<div class="outline-text-3" id="text-2-44">
<p>
Two players play a game. Player A wants to maximize the score, while player B wants to minimize the score.
</p>
<ul class="org-ul">
<li>Do a DFS (post order), player A and B take turns to maximize/minimize the score at each level.</li>
<li>Note: we might be able to the prune the tree if there is no need to explore deeper.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgfa13969" class="outline-2">
<h2 id="orgfa13969"><span class="section-number-2">3</span> Learning Resources</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgaed8ddf" class="outline-3">
<h3 id="orgaed8ddf"><span class="section-number-3">3.1</span> Structure and Interpretation of Computer Programs (SICP)</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-orga46a5b0" class="outline-4">
<h4 id="orga46a5b0"><span class="section-number-4">3.1.1</span> Video link</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
<a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/video-lectures/">https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/video-lectures/</a>
</p>
</div>
</div>
<div id="outline-container-orge50e8d8" class="outline-4">
<h4 id="orge50e8d8"><span class="section-number-4">3.1.2</span> SICP in python</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
<a href="https://composingprograms.com/">https://composingprograms.com/</a>
</p>
</div>
</div>
<div id="outline-container-org34668fe" class="outline-4">
<h4 id="org34668fe"><span class="section-number-4">3.1.3</span> SICP in scheme</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
<a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-10.html#%_sec_1.1">https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-10.html#%_sec_1.1</a>
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org61d6892" class="outline-2">
<h2 id="org61d6892"><span class="section-number-2">4</span> P, NP, NP-complete, NP-hard</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>P: the set of problems that can be solved in polynomial time.</li>
<li>NP (Nondeterministic polynomial time): the set of problems that can be verified (whether the provided solution is correct or not) in polynomial time given a potential solution.</li>
<li>NP-complete: a problem p <b><b>in NP</b></b> is an NP-complete problem if every other problems in NP can be reduced to p in polynomial time. That is any problems belong to both NP-hard and NP. A solution to an NP-complete problem can be verified "quickly", but there is no known way to find a solution quickly.</li>
<li>NP-hard: a decision problem p is NP-hard if every problem in NP can be reduced to p in polynomial time.</li>
</ul>
</div>
</div>
<div id="outline-container-org78a83fb" class="outline-2">
<h2 id="org78a83fb"><span class="section-number-2">5</span> Catalan Number</h2>
<div class="outline-text-2" id="text-5">
<p>
\[C_0 = 1\]
\[C_{n+1} = \sum_{i=0}{n} C_i C_{n - i}\]
The formula indicates a recursion scheme.
</p>

<p>
Related to generate parentheses problem, generate full binary tree problem, monotonic path problem (number of "move right" must be larger than number of "move up" in the grid, so always traveling the grid under its diagonal)
<a href="https://en.wikipedia.org/wiki/Catalan_number">https://en.wikipedia.org/wiki/Catalan_number</a>
</p>
</div>
</div>
<div id="outline-container-orgd3cbb7c" class="outline-2">
<h2 id="orgd3cbb7c"><span class="section-number-2">6</span> ASCII</h2>
<div class="outline-text-2" id="text-6">
<p>
Pronunciation: ass-key :)
Extended ASCII encodes 256 characters (0 - 255).
Therefore, a char usually takes 1 byte (8 bits).
</p>
</div>
</div>
<div id="outline-container-org606962d" class="outline-2">
<h2 id="org606962d"><span class="section-number-2">7</span> Convert int to byte string</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">int_to_byte</span><span style="color: #AE81FF;">(</span>num<span style="color: #AE81FF;">)</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">assuming int is 32 bit</span>
    <span style="color: #FD971F;">byte</span> = <span style="color: #AE81FF;">[</span><span style="color: #F92672;">chr</span><span style="color: #66D9EF;">(</span>num &gt;&gt; i * <span style="color: #AE81FF;">8</span> &amp; <span style="color: #AE81FF;">0xff</span><span style="color: #66D9EF;">)</span> <span style="color: #F92672;">for</span> i <span style="color: #F92672;">in</span> <span style="color: #F92672;">range</span><span style="color: #66D9EF;">(</span><span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">]</span>
    byte.reverse<span style="color: #AE81FF;">()</span>
    <span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>byte<span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">byte_str</span> = <span style="color: #E6DB74;">''</span>.join<span style="color: #AE81FF;">(</span>byte<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> <span style="color: #E6DB74;">''</span>.join<span style="color: #AE81FF;">(</span>byte<span style="color: #AE81FF;">)</span>

<span style="color: #F92672;">def</span> <span style="color: #A6E22E;">byte_to_int</span><span style="color: #AE81FF;">(</span>byte<span style="color: #AE81FF;">)</span>:
    <span style="color: #FD971F;">res</span> = <span style="color: #AE81FF;">0</span>
    <span style="color: #F92672;">for</span> i, c <span style="color: #F92672;">in</span> <span style="color: #F92672;">enumerate</span><span style="color: #AE81FF;">(</span>byte<span style="color: #AE81FF;">)</span>:
        <span style="color: #FD971F;">res</span> += <span style="color: #F92672;">ord</span><span style="color: #AE81FF;">(</span>c<span style="color: #AE81FF;">)</span> &lt;&lt; <span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">3</span> - i<span style="color: #AE81FF;">)</span> * <span style="color: #AE81FF;">8</span>
    <span style="color: #F92672;">return</span> res

<span style="color: #FD971F;">b</span> = int_to_byte<span style="color: #AE81FF;">(</span><span style="color: #AE81FF;">12</span><span style="color: #AE81FF;">)</span>
<span style="color: #F92672;">print</span><span style="color: #AE81FF;">(</span>byte_to_int<span style="color: #66D9EF;">(</span>b<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<pre class="example">
['\x00', '\x00', '\x00', '\x0c']
12

</pre>
</div>
</div>
<div id="outline-container-org333b3b1" class="outline-2">
<h2 id="org333b3b1"><span class="section-number-2">8</span> Rotation Matrix</h2>
<div class="outline-text-2" id="text-8">
<p>
\[R = \begin{bmatrix}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta
\end{bmatrix}\]
</p>

<p>
Therefore, turn left 90 degree (anti-clockwise):
\[R = \begin{bmatrix}
0 & -1 \\
1 & 0
\end{bmatrix}\]
</p>

<p>
\[R \begin{bmatrix}
x \\
y
\end{bmatrix} =
\begin{bmatrix}
-y \\
x
\end{bmatrix}\]
</p>

<p>
Turn right 90 degree (clockwise):
\[R = \begin{bmatrix}
0 & 1 \\
-1 & 0
\end{bmatrix}\]
</p>

<p>
\[R \begin{bmatrix}
x \\
y
\end{bmatrix} =
\begin{bmatrix}
y \\
-x
\end{bmatrix}\]
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Jinyu Xie</p>
<p class="date">Created: 2020-05-16 Sat 23:20</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
